set(0, 'defaultLegendInterpreter', 'latex');
set(0, 'defaultLegendFontName', 'Times New Roman');

%设计常数
r=3/5;
lambda110=6000;lambda111=6000;lambda210=25000;lambda211=25000;
A11=[76 16];phi11=inv([0 1;-76 -16]);P11=[1.2489 0.1313;0.1313 0.0166];
P11L=P11(:,2);tau11=6;tau12=6;sigmaf11=6;sigmaj11=3;betac11=5;
betaa11=8;etarho1=2;deltarho1=2;psi1=1;sigmaf12=7;sigmaj12=8;
betac12=4;betaa12=6;
A12=5;phi12=inv([-5]);P12=1;l111=2;l112=2;l121=2;l211=3;l212=3;l221=3;
A21=[76 16];phi21=inv([0 1;-76 -16]);P21=[1.2489 0.1313;0.1313 0.0166];
P21L=P21(:,2);psi2=1;A22=5;phi22=inv([-5]);P22=1;tau21=6;tau22=6;
sigmaf21=8;sigmaj21=3;betac21=5;betaa21=8;etarho2=2;deltarho2=2;
sigmaf22=7;sigmaj22=8;betac22=4;betaa22=6;
%追踪轨迹
x11c=@(t)(sin(t));
x21c=@(t)(0.5*sin(t)+0.5*sin(0.5*t));
%定义函数
H111=@(t)(t^4);H112=@(t)(t^4);H211=@(t)(t^2);
%初值
z1_0=0.3;z2_0=0.1;z3_0=0.1;p1_0=0.1;p2_0=0.1;p3_0=0.1;
psi110_0=0.4;psi111_0=0.2;psi210_0=0.4;psi211_0=0.2;
thetaf111_0=0.6;thetaf112_0=0.6;thetaf113_0=6;thetaf114_0=0.6;thetaf115_0=0.6;thetaf116_0=0.6;
thetaf117_0=0.6;thetaf118_0=0.6;thetac111_0=0.5;thetac112_0=0.5;thetac113_0=0.5;thetac114_0=0.5;
thetac115_0=0.5;thetac116_0=0.5;thetac117_0=0.5;thetac118_0=0.5;thetaa111_0=0.2;thetaa112_0=0.2;
thetaa113_0=0.2;thetaa114_0=0.2;thetaa115_0=0.2;thetaa116_0=0.2;thetaa117_0=0.2;thetaa118_0=0.2;
thetaf121_0=0.8;thetaf122_0=0.8;thetaf123_0=0.8;thetaf124_0=0.8;thetaf125_0=0.8;thetaf126_0=0.8;
thetaf127_0=0.8;thetaf128_0=0.8;thetac121_0=0.6;thetac122_0=0.6;thetac123_0=0.6;thetac124_0=0.6;
thetac125_0=0.6;thetac126_0=0.6;thetac127_0=0.6;thetac128_0=0.6;thetaa121_0=0.3;thetaa122_0=0.3;
thetaa123_0=0.3;thetaa124_0=0.3;thetaa125_0=0.3;thetaa126_0=0.3;thetaa127_0=0.3;thetaa128_0=0.3;
thetaf211_0=0.6;thetaf212_0=0.6;thetaf213_0=0.6;thetaf214_0=0.6;thetaf215_0=0.6;thetaf216_0=0.6;
thetaf217_0=0.6;thetaf218_0=0.6;thetac211_0=0.5;thetac212_0=0.5;thetac213_0=0.5;thetac214_0=0.5;
thetac215_0=0.5;thetac216_0=0.5;thetac217_0=0.5;thetac218_0=0.5;thetaa211_0=0.2;thetaa212_0=0.2;
thetaa213_0=0.2;thetaa214_0=0.2;thetaa215_0=0.2;thetaa216_0=0.2;thetaa217_0=0.2;thetaa218_0=0.2;
thetaf221_0=0.8;thetaf222_0=0.8;thetaf223_0=0.8;thetaf224_0=0.8;thetaf225_0=0.8;thetaf226_0=0.8;
thetaf227_0=0.8;thetaf228_0=0.8;thetac221_0=0.6;thetac222_0=0.6;thetac223_0=0.6;thetac224_0=0.6;
thetac225_0=0.6;thetac226_0=0.6;thetac227_0=0.6;thetac228_0=0.6;thetaa221_0=0.3;thetaa222_0=0.3;
thetaa223_0=0.3;thetaa224_0=0.3;thetaa225_0=0.3;thetaa226_0=0.3;thetaa227_0=0.3;thetaa228_0=0.3;
rho1_0=0.6;rho2_0=0.6;
E111_0=0;E112_0=0;E121_0=0;E211_0=0;E212_0=0;E221_0=0;
h=0.001;%步长
%初始化数组
t=0:h:10;
n=length(t);
t1=0:h:9.999;
z1=zeros(n,1);z2=zeros(n,1);z3=zeros(n,1);
p1=zeros(n,1);p2=zeros(n,1);p3=zeros(n,1);
psi210=zeros(n,1);psi211=zeros(n,1);
psi110=zeros(n,1);psi111=zeros(n,1);
thetaf111=zeros(n,1);thetaf112=zeros(n,1);thetaf113=zeros(n,1);
thetaf114=zeros(n,1);thetaf115=zeros(n,1);thetaf116=zeros(n,1);
thetaf117=zeros(n,1);thetaf118=zeros(n,1);thetac111=zeros(n,1);
thetac112=zeros(n,1);thetac113=zeros(n,1);thetac114=zeros(n,1);
thetac115=zeros(n,1);thetac116=zeros(n,1);thetac117=zeros(n,1);
thetac118=zeros(n,1);thetaa111=zeros(n,1);thetaa112=zeros(n,1);
thetaa113=zeros(n,1);thetaa114=zeros(n,1);thetaa115=zeros(n,1);
thetaa116=zeros(n,1);thetaa117=zeros(n,1);thetaa118=zeros(n,1);
thetaf121=zeros(n,1);thetaf122=zeros(n,1);thetaf123=zeros(n,1);
thetaf124=zeros(n,1);thetaf125=zeros(n,1);thetaf126=zeros(n,1);
thetaf127=zeros(n,1);thetaf128=zeros(n,1);thetac121=zeros(n,1);
thetac122=zeros(n,1);thetac123=zeros(n,1);thetac124=zeros(n,1);
thetac125=zeros(n,1);thetac126=zeros(n,1);thetac127=zeros(n,1);
thetac128=zeros(n,1);thetaa121=zeros(n,1);thetaa122=zeros(n,1);
thetaa123=zeros(n,1);thetaa124=zeros(n,1);thetaa125=zeros(n,1);
thetaa126=zeros(n,1);thetaa127=zeros(n,1);thetaa128=zeros(n,1);
thetaf211=zeros(n,1);thetaf212=zeros(n,1);thetaf213=zeros(n,1);
thetaf214=zeros(n,1);thetaf215=zeros(n,1);thetaf216=zeros(n,1);
thetaf217=zeros(n,1);thetaf218=zeros(n,1);thetac211=zeros(n,1);
thetac212=zeros(n,1);thetac213=zeros(n,1);thetac214=zeros(n,1);
thetac215=zeros(n,1);thetac216=zeros(n,1);thetac217=zeros(n,1);
thetac218=zeros(n,1);thetaa211=zeros(n,1);thetaa212=zeros(n,1);
thetaa213=zeros(n,1);thetaa214=zeros(n,1);thetaa215=zeros(n,1);
thetaa216=zeros(n,1);thetaa217=zeros(n,1);thetaa218=zeros(n,1);
thetaf221=zeros(n,1);thetaf222=zeros(n,1);thetaf223=zeros(n,1);
thetaf224=zeros(n,1);thetaf225=zeros(n,1);thetaf226=zeros(n,1);
thetaf227=zeros(n,1);thetaf228=zeros(n,1);thetac221=zeros(n,1);
thetac222=zeros(n,1);thetac223=zeros(n,1);thetac224=zeros(n,1);
thetac225=zeros(n,1);thetac226=zeros(n,1);thetac227=zeros(n,1);
thetac228=zeros(n,1);thetaa221=zeros(n,1);thetaa222=zeros(n,1);
thetaa223=zeros(n,1);thetaa224=zeros(n,1);thetaa225=zeros(n,1);
thetaa226=zeros(n,1);thetaa227=zeros(n,1);thetaa228=zeros(n,1);
%画图
thetaf11=zeros(n,1);thetaf12=zeros(n,1);thetaf21=zeros(n,1);thetaf22=zeros(n,1);
thetac11=zeros(n,1);thetac12=zeros(n,1);thetac21=zeros(n,1);thetac22=zeros(n,1);
thetaa11=zeros(n,1);thetaa12=zeros(n,1);thetaa21=zeros(n,1);thetaa22=zeros(n,1);
h11=zeros(n-1,1);h12=zeros(n-1,1);h21=zeros(n-1,1);h22=zeros(n-1,1);
u2=zeros(n-1,1);u1=zeros(n-1,1);
%设置初始条件
z1(1)=z1_0;z2(1)=z2_0;z3(1)=z3_0;
p1(1)=p1_0;p2(1)=p2_0;p3(1)=p3_0;
E111(1)=E111_0;E112(1)=E112_0;E121(1)=E121_0;
psi110(1)=psi110_0;psi111(1)=psi111_0;psi210(1)=psi210_0;psi211(1)=psi211_0;
rho1(1)=rho1_0;E211(1)=E211_0;E212(1)=E212_0;E221(1)=E221_0;
rho2(1)=rho2_0;
thetaf111(1)=thetaf111_0;thetaf112(1)=thetaf112_0;thetaf113(1)=thetaf113_0;thetaf114(1)=thetaf114_0;
thetaf115(1)=thetaf115_0;thetaf116(1)=thetaf116_0;thetaf117(1)=thetaf117_0;thetaf118(1)=thetaf118_0;
thetac111(1)=thetac111_0;thetac112(1)=thetac112_0;thetac113(1)=thetac113_0;thetac114(1)=thetac114_0;
thetac115(1)=thetac115_0;thetac116(1)=thetac116_0;thetac117(1)=thetac117_0;thetac118(1)=thetac118_0;
thetaf121(1)=thetaf121_0;thetaf122(1)=thetaf122_0;thetaf123(1)=thetaf123_0;thetaf124(1)=thetaf124_0;
thetaf125(1)=thetaf125_0;thetaf126(1)=thetaf126_0;thetaf127(1)=thetaf127_0;thetaf128(1)=thetaf128_0;
thetac121(1)=thetac121_0;thetac122(1)=thetac122_0;thetac123(1)=thetac123_0;thetac124(1)=thetac124_0;
thetac125(1)=thetac125_0;thetac126(1)=thetac126_0;thetac127(1)=thetac127_0;thetac128(1)=thetac128_0;
thetaa121(1)=thetaa121_0;thetaa122(1)=thetaa122_0;thetaa123(1)=thetaa123_0;thetaa124(1)=thetaa124_0;
thetaa125(1)=thetaa125_0;thetaa126(1)=thetaa126_0;thetaa127(1)=thetaa127_0;thetaa128(1)=thetaa128_0;
thetaf211(1)=thetaf211_0;thetaf212(1)=thetaf212_0;thetaf213(1)=thetaf213_0;thetaf214(1)=thetaf214_0;
thetaf215(1)=thetaf215_0;thetaf216(1)=thetaf216_0;thetaf217(1)=thetaf217_0;thetaf218(1)=thetaf218_0;
thetac211(1)=thetac211_0;thetac212(1)=thetac212_0;thetac213(1)=thetac213_0;thetac214(1)=thetac214_0;
thetac215(1)=thetac215_0;thetac216(1)=thetac216_0;thetac217(1)=thetac217_0;thetac218(1)=thetac218_0;
thetaf221(1)=thetaf221_0;thetaf222(1)=thetaf222_0;thetaf223(1)=thetaf223_0;thetaf224(1)=thetaf224_0;
thetaf225(1)=thetaf225_0;thetaf226(1)=thetaf226_0;thetaf227(1)=thetaf227_0;thetaf228(1)=thetaf228_0;
thetac221(1)=thetac221_0;thetac222(1)=thetac222_0;thetac223(1)=thetac223_0;thetac224(1)=thetac224_0;
thetac225(1)=thetac225_0;thetac226(1)=thetac226_0;thetac227(1)=thetac227_0;thetac228(1)=thetac228_0;
thetaa221(1)=thetaa221_0;thetaa222(1)=thetaa222_0;thetaa223(1)=thetaa223_0;thetaa224(1)=thetaa224_0;
thetaa225(1)=thetaa225_0;thetaa226(1)=thetaa226_0;thetaa227(1)=thetaa227_0;thetaa228(1)=thetaa228_0;
for i=1:n-1
    wf111(i)=exp(-(norm([z1(i);z2(i)]-[8.5;8.5]+[1;1])).^2/(2^2));
    wf112(i)=exp(-(norm([z1(i);z2(i)]-[8.5;8.5]+[2;2])).^2/(2^2));
    wf113(i)=exp(-(norm([z1(i);z2(i)]-[8.5;8.5]+[3;3])).^2/(2^2));
    wf114(i)=exp(-(norm([z1(i);z2(i)]-[8.5;8.5]+[4;4])).^2/(2^2));
    wf115(i)=exp(-(norm([z1(i);z2(i)]-[8.5;8.5]+[5;5])).^2/(2^2));
    wf116(i)=exp(-(norm([z1(i);z2(i)]-[8.5;8.5]+[6;6])).^2/(2^2));
    wf117(i)=exp(-(norm([z1(i);z2(i)]-[8.5;8.5]+[7;7])).^2/(2^2));
    wf118(i)=exp(-(norm([z1(i);z2(i)]-[8.5;8.5]+[8;8])).^2/(2^2));
    w1(i)=(2*transpose(P11L)*[z1(i)-sin((i-1)*h)-E111(i);z2(i)-cos((i-1)*h)-E112(i)])*(H211(z1(i))+H111(z1(i)))/...
        ((transpose(P11L)*[z1(i)-sin((i-1)*h)-E111(i);z2(i)-cos((i-1)*h)-E112(i)])*(transpose(P11L)*[z1(i)-sin((i-1)*h)-E111(i);z2(i)-cos((i-1)*h)-E112(i)])+psi1);
    wj111(i)=exp(-(norm([z1(i);z2(i);z1(i)-sin((i-1)*h);-sin((i-1)*h);z1(i)-sin((i-1)*h)-E111(i);z2(i)-cos((i-1)*h)-E112(i);z2(i)-cos((i-1)*h)]-...
        [8.5;8.5;8.5;8.5;8.5;8.5;8.5]+[1;1;1;1;1;1;1]))^2/(2^2));
    wj112(i)=exp(-(norm([z1(i);z2(i);z1(i)-sin((i-1)*h);-sin((i-1)*h);z1(i)-sin((i-1)*h)-E111(i);z2(i)-cos((i-1)*h)-E112(i);z2(i)-cos((i-1)*h)]-...
        [8.5;8.5;8.5;8.5;8.5;8.5;8.5]+[2;2;2;2;2;2;2]))^2/(2^2));
    wj113(i)=exp(-(norm([z1(i);z2(i);z1(i)-sin((i-1)*h);-sin((i-1)*h);z1(i)-sin((i-1)*h)-E111(i);z2(i)-cos((i-1)*h)-E112(i);z2(i)-cos((i-1)*h)]-...
        [8.5;8.5;8.5;8.5;8.5;8.5;8.5]+[3;3;3;3;3;3;3]))^2/(2^2));
    wj114(i)=exp(-(norm([z1(i);z2(i);z1(i)-sin((i-1)*h);-sin((i-1)*h);z1(i)-sin((i-1)*h)-E111(i);z2(i)-cos((i-1)*h)-E112(i);z2(i)-cos((i-1)*h)]-...
        [8.5;8.5;8.5;8.5;8.5;8.5;8.5]+[4;4;4;4;4;4;4]))^2/(2^2));
    wj115(i)=exp(-(norm([z1(i);z2(i);z1(i)-sin((i-1)*h);-sin((i-1)*h);z1(i)-sin((i-1)*h)-E111(i);z2(i)-cos((i-1)*h)-E112(i);z2(i)-cos((i-1)*h)]-...
        [8.5;8.5;8.5;8.5;8.5;8.5;8.5]+[5;5;5;5;5;5;5]))^2/(2^2));
    wj116(i)=exp(-(norm([z1(i);z2(i);z1(i)-sin((i-1)*h);-sin((i-1)*h);z1(i)-sin((i-1)*h)-E111(i);z2(i)-cos((i-1)*h)-E112(i);z2(i)-cos((i-1)*h)]-...
        [8.5;8.5;8.5;8.5;8.5;8.5;8.5]+[6;6;6;6;6;6;6]))^2/(2^2));
    wj117(i)=exp(-(norm([z1(i);z2(i);z1(i)-sin((i-1)*h);-sin((i-1)*h);z1(i)-sin((i-1)*h)-E111(i);z2(i)-cos((i-1)*h)-E112(i);z2(i)-cos((i-1)*h)]-...
        [8.5;8.5;8.5;8.5;8.5;8.5;8.5]+[7;7;7;7;7;7;7]))^2/(2^2));
    wj118(i)=exp(-(norm([z1(i);z2(i);z1(i)-sin((i-1)*h);-sin((i-1)*h);z1(i)-sin((i-1)*h)-E111(i);z2(i)-cos((i-1)*h)-E112(i);z2(i)-cos((i-1)*h)]-...
        [8.5;8.5;8.5;8.5;8.5;8.5;8.5]+[8;8;8;8;8;8;8]))^2/(2^2));
    a1(i)=-A11*[z1(i)-sin((i-1)*h);z2(i)-cos((i-1)*h)]+A11*phi11*[(z1(i)-sin((i-1)*h)-E111(i))^r;...
        (z2(i)-cos((i-1)*h)-E112(i))^r]-sin((i-1)*h)-(thetaf111(i)*wf111(i)+thetaf112(i)*wf112(i)+thetaf113(i)*wf113(i)...
        +thetaf114(i)*wf114(i)+thetaf115(i)*wf115(i)+thetaf116(i)*wf116(i)+thetaf117(i)*wf117(i)+thetaf118(i)*wf118(i))...
        -rho1(i)*w1(i)-0.5*(thetaa111(i)*wj111(i)+thetaa112(i)*wj112(i)+thetaa113(i)*wj113(i)+thetaa114(i)*wj114(i)...
        +thetaa115(i)*wj115(i)+thetaa116(i)*wj116(i)+thetaa117(i)*wj117(i)+thetaa118(i)*wj118(i));
    E111(i+1)=E111(i)+h*E112(i);
    E112(i+1)=E112(i)+h*(-A11*[E111(i);E112(i)]+E121(i)+(psi110(i)-a1(i))-l111*sign(E111(i))...
        -l112*sign(E112(i)));
    E121(i+1)=E121(i)+h*(-A12*E121(i)-l121*sign(E121(i)));
    thetaf111(i+1)=thetaf111(i)+h*tau11*(wf111(i)*[z1(i)-sin((i-1)*h)-E111(i) z2(i)-cos((i-1)*h)-E112(i)]*P11L-sigmaf11*thetaf111(i)-thetaf111(i));
    thetaf112(i+1)=thetaf112(i)+h*tau11*(wf112(i)*[z1(i)-sin((i-1)*h)-E111(i) z2(i)-cos((i-1)*h)-E112(i)]*P11L-sigmaf11*thetaf112(i)-thetaf112(i));
    thetaf113(i+1)=thetaf113(i)+h*tau11*(wf113(i)*[z1(i)-sin((i-1)*h)-E111(i) z2(i)-cos((i-1)*h)-E112(i)]*P11L-sigmaf11*thetaf113(i)-thetaf113(i));
    thetaf114(i+1)=thetaf114(i)+h*tau11*(wf114(i)*[z1(i)-sin((i-1)*h)-E111(i) z2(i)-cos((i-1)*h)-E112(i)]*P11L-sigmaf11*thetaf114(i)-thetaf114(i));
    thetaf115(i+1)=thetaf115(i)+h*tau11*(wf115(i)*[z1(i)-sin((i-1)*h)-E111(i) z2(i)-cos((i-1)*h)-E112(i)]*P11L-sigmaf11*thetaf115(i)-thetaf115(i));
    thetaf116(i+1)=thetaf116(i)+h*tau11*(wf116(i)*[z1(i)-sin((i-1)*h)-E111(i) z2(i)-cos((i-1)*h)-E112(i)]*P11L-sigmaf11*thetaf116(i)-thetaf116(i));
    thetaf117(i+1)=thetaf117(i)+h*tau11*(wf117(i)*[z1(i)-sin((i-1)*h)-E111(i) z2(i)-cos((i-1)*h)-E112(i)]*P11L-sigmaf11*thetaf117(i)-thetaf117(i));
    thetaf118(i+1)=thetaf118(i)+h*tau11*(wf118(i)*[z1(i)-sin((i-1)*h)-E111(i) z2(i)-cos((i-1)*h)-E112(i)]*P11L-sigmaf11*thetaf118(i)-thetaf118(i));
    thetac111(i+1)=thetac111(i)+h*(-betac11*((wj111(i)*wj111(i)+sigmaj11)*thetac111(i)+wj111(i)*wj112(i)*thetac112(i)+wj111(i)*wj113(i)*thetac113(i)+...
        wj111(i)*wj114(i)*thetac114(i)+wj111(i)*wj115(i)*thetac115(i)+wj111(i)*wj116(i)*thetac116(i)+wj111(i)*wj117(i)*thetac117(i)+...
        wj111(i)*wj118(i)*thetac118(i))-thetac111(i));
    thetac112(i+1)=thetac112(i)+h*(-betac11*(wj112(i)*wj111(i)*thetac111(i)+(wj112(i)*wj112(i)+sigmaj11)*thetac112(i)+wj112(i)*wj113(i)*thetac113(i)+...
        wj112(i)*wj114(i)*thetac114(i)+wj112(i)*wj115(i)*thetac115(i)+wj112(i)*wj116(i)*thetac116(i)+wj112(i)*wj117(i)*thetac117(i)+...
        wj112(i)*wj118(i)*thetac118(i))-thetac112(i));
    thetac113(i+1)=thetac113(i)+h*(-betac11*(wj113(i)*wj111(i)*thetac111(i)+wj113(i)*wj112(i)*thetac112(i)+(wj113(i)*wj113(i)+sigmaj11)*thetac113(i)+...
        wj113(i)*wj114(i)*thetac114(i)+wj113(i)*wj115(i)*thetac115(i)+wj113(i)*wj116(i)*thetac116(i)+wj113(i)*wj117(i)*thetac117(i)+...
        wj113(i)*wj118(i)*thetac118(i))-thetac113(i));
    thetac114(i+1)=thetac114(i)+h*(-betac11*(wj114(i)*wj111(i)*thetac111(i)+wj114(i)*wj112(i)*thetac112(i)+wj114(i)*wj113(i)*thetac113(i)+...
        (wj114(i)*wj114(i)+sigmaj11)*thetac114(i)+wj114(i)*wj115(i)*thetac115(i)+wj114(i)*wj116(i)*thetac116(i)+wj114(i)*wj117(i)*thetac117(i)+...
        wj114(i)*wj118(i)*thetac118(i))-thetac114(i));
    thetac115(i+1)=thetac115(i)+h*(-betac11*(wj115(i)*wj111(i)*thetac111(i)+wj115(i)*wj112(i)*thetac112(i)+wj115(i)*wj113(i)*thetac113(i)+...
        wj115(i)*wj114(i)*thetac114(i)+(wj115(i)*wj115(i)+sigmaj11)*thetac115(i)+wj115(i)*wj116(i)*thetac116(i)+wj115(i)*wj117(i)*thetac117(i)+...
        wj115(i)*wj118(i)*thetac118(i))-thetac115(i));
    thetac116(i+1)=thetac116(i)+h*(-betac11*(wj116(i)*wj111(i)*thetac111(i)+wj116(i)*wj112(i)*thetac112(i)+wj116(i)*wj113(i)*thetac113(i)+...
        wj116(i)*wj114(i)*thetac114(i)+wj116(i)*wj115(i)*thetac115(i)+(wj116(i)*wj116(i)+sigmaj11)*thetac116(i)+wj116(i)*wj117(i)*thetac117(i)+...
        wj116(i)*wj118(i)*thetac118(i))-thetac116(i));
    thetac117(i+1)=thetac117(i)+h*(-betac11*(wj117(i)*wj111(i)*thetac111(i)+wj117(i)*wj112(i)*thetac112(i)+wj117(i)*wj113(i)*thetac113(i)+...
        wj117(i)*wj114(i)*thetac114(i)+wj117(i)*wj115(i)*thetac115(i)+wj117(i)*wj116(i)*thetac116(i)+(wj117(i)*wj117(i)+sigmaj11)*thetac117(i)+...
        wj117(i)*wj118(i)*thetac118(i))-thetac117(i));
    thetac118(i+1)=thetac118(i)+h*(-betac11*(wj118(i)*wj111(i)*thetac111(i)+wj118(i)*wj112(i)*thetac112(i)+wj118(i)*wj113(i)*thetac113(i)+...
        wj118(i)*wj114(i)*thetac114(i)+wj118(i)*wj115(i)*thetac115(i)+wj118(i)*wj116(i)*thetac116(i)+wj118(i)*wj117(i)*thetac117(i)+...
        (wj118(i)*wj118(i)+sigmaj11)*thetac118(i))-thetac118(i));
    thetaa111(i+1)=thetaa111(i)+h*(-((wj111(i)*wj111(i)+sigmaj11)*(betaa11*(thetaa111(i)-thetac111(i))+betac11*thetac111(i))+wj111(i)*wj112(i)*(betaa11*(thetaa112(i)-thetac112(i))+betac11*thetac112(i))+...
        wj111(i)*wj113(i)*(betaa11*(thetaa113(i)-thetac113(i))+betac11*thetac113(i))+wj111(i)*wj114(i)*(betaa11*(thetaa114(i)-thetac114(i))+betac11*thetac114(i))+...
        wj111(i)*wj115(i)*(betaa11*(thetaa115(i)-thetac115(i))+betac11*thetac115(i))+wj111(i)*wj116(i)*(betaa11*(thetaa116(i)-thetac116(i))+betac11*thetac116(i))+...
        wj111(i)*wj117(i)*(betaa11*(thetaa117(i)-thetac117(i))+betac11*thetac117(i))+wj111(i)*wj118(i)*(betaa11*(thetaa118(i)-thetac118(i))+betac11*thetac118(i)))-thetaa111(i));
    thetaa112(i+1)=thetaa112(i)+h*(-(wj112(i)*wj111(i)*(betaa11*(thetaa111(i)-thetac111(i))+betac11*thetac111(i))+(wj112(i)*wj112(i)+sigmaj11)*(betaa11*(thetaa112(i)-thetac112(i))+betac11*thetac112(i))+...
        wj112(i)*wj113(i)*(betaa11*(thetaa113(i)-thetac113(i))+betac11*thetac113(i))+wj112(i)*wj114(i)*(betaa11*(thetaa114(i)-thetac114(i))+betac11*thetac114(i))+...
        wj112(i)*wj115(i)*(betaa11*(thetaa115(i)-thetac115(i))+betac11*thetac115(i))+wj112(i)*wj116(i)*(betaa11*(thetaa116(i)-thetac116(i))+betac11*thetac116(i))+...
        wj112(i)*wj117(i)*(betaa11*(thetaa117(i)-thetac117(i))+betac11*thetac117(i))+wj112(i)*wj118(i)*(betaa11*(thetaa118(i)-thetac118(i))+betac11*thetac118(i)))-thetaa112(i));
    thetaa113(i+1)=thetaa113(i)+h*(-(wj113(i)*wj111(i)*(betaa11*(thetaa111(i)-thetac111(i))+betac11*thetac111(i))+wj113(i)*wj112(i)*(betaa11*(thetaa112(i)-thetac112(i))+betac11*thetac112(i))+...
        (wj113(i)*wj113(i)+sigmaj11)*(betaa11*(thetaa113(i)-thetac113(i))+betac11*thetac113(i))+wj113(i)*wj114(i)*(betaa11*(thetaa114(i)-thetac114(i))+betac11*thetac114(i))+...
        wj113(i)*wj115(i)*(betaa11*(thetaa115(i)-thetac115(i))+betac11*thetac115(i))+wj113(i)*wj116(i)*(betaa11*(thetaa116(i)-thetac116(i))+betac11*thetac116(i))+...
        wj113(i)*wj117(i)*(betaa11*(thetaa117(i)-thetac117(i))+betac11*thetac117(i))+wj113(i)*wj118(i)*(betaa11*(thetaa118(i)-thetac118(i))+betac11*thetac118(i)))-thetaa113(i));
    thetaa114(i+1)=thetaa114(i)+h*(-(wj114(i)*wj111(i)*(betaa11*(thetaa111(i)-thetac111(i))+betac11*thetac111(i))+wj114(i)*wj112(i)*(betaa11*(thetaa112(i)-thetac112(i))+betac11*thetac112(i))+...
        wj114(i)*wj113(i)*(betaa11*(thetaa113(i)-thetac113(i))+betac11*thetac113(i))+(wj114(i)*wj114(i)+sigmaj11)*(betaa11*(thetaa114(i)-thetac114(i))+betac11*thetac114(i))+...
        wj114(i)*wj115(i)*(betaa11*(thetaa115(i)-thetac115(i))+betac11*thetac115(i))+wj114(i)*wj116(i)*(betaa11*(thetaa116(i)-thetac116(i))+betac11*thetac116(i))+...
        wj114(i)*wj117(i)*(betaa11*(thetaa117(i)-thetac117(i))+betac11*thetac117(i))+wj114(i)*wj118(i)*(betaa11*(thetaa118(i)-thetac118(i))+betac11*thetac118(i)))-thetaa114(i));
    thetaa115(i+1)=thetaa115(i)+h*(-(wj115(i)*wj111(i)*(betaa11*(thetaa111(i)-thetac111(i))+betac11*thetac111(i))+wj115(i)*wj112(i)*(betaa11*(thetaa112(i)-thetac112(i))+betac11*thetac112(i))+...
        wj115(i)*wj113(i)*(betaa11*(thetaa113(i)-thetac113(i))+betac11*thetac113(i))+wj115(i)*wj114(i)*(betaa11*(thetaa114(i)-thetac114(i))+betac11*thetac114(i))+...
        (wj115(i)*wj115(i)+sigmaj11)*(betaa11*(thetaa115(i)-thetac115(i))+betac11*thetac115(i))+wj115(i)*wj116(i)*(betaa11*(thetaa116(i)-thetac116(i))+betac11*thetac116(i))+...
        wj115(i)*wj117(i)*(betaa11*(thetaa117(i)-thetac117(i))+betac11*thetac117(i))+wj115(i)*wj118(i)*(betaa11*(thetaa118(i)-thetac118(i))+betac11*thetac118(i)))-thetaa115(i));
    thetaa116(i+1)=thetaa116(i)+h*(-(wj116(i)*wj111(i)*(betaa11*(thetaa111(i)-thetac111(i))+betac11*thetac111(i))+wj116(i)*wj112(i)*(betaa11*(thetaa112(i)-thetac112(i))+betac11*thetac112(i))+...
        wj116(i)*wj113(i)*(betaa11*(thetaa113(i)-thetac113(i))+betac11*thetac113(i))+wj116(i)*wj114(i)*(betaa11*(thetaa114(i)-thetac114(i))+betac11*thetac114(i))+...
        wj116(i)*wj115(i)*(betaa11*(thetaa115(i)-thetac115(i))+betac11*thetac115(i))+(wj116(i)*wj116(i)+sigmaj11)*(betaa11*(thetaa116(i)-thetac116(i))+betac11*thetac116(i))+...
        wj116(i)*wj117(i)*(betaa11*(thetaa117(i)-thetac117(i))+betac11*thetac117(i))+wj116(i)*wj118(i)*(betaa11*(thetaa118(i)-thetac118(i))+betac11*thetac118(i)))-thetaa116(i));
    thetaa117(i+1)=thetaa117(i)+h*(-(wj117(i)*wj111(i)*(betaa11*(thetaa111(i)-thetac111(i))+betac11*thetac111(i))+wj117(i)*wj112(i)*(betaa11*(thetaa112(i)-thetac112(i))+betac11*thetac112(i))+...
        wj117(i)*wj113(i)*(betaa11*(thetaa113(i)-thetac113(i))+betac11*thetac113(i))+wj117(i)*wj114(i)*(betaa11*(thetaa114(i)-thetac114(i))+betac11*thetac114(i))+...
        wj117(i)*wj115(i)*(betaa11*(thetaa115(i)-thetac115(i))+betac11*thetac115(i))+wj117(i)*wj116(i)*(betaa11*(thetaa116(i)-thetac116(i))+betac11*thetac116(i))+...
        (wj117(i)*wj117(i)+sigmaj11)*(betaa11*(thetaa117(i)-thetac117(i))+betac11*thetac117(i))+wj117(i)*wj118(i)*(betaa11*(thetaa118(i)-thetac118(i))+betac11*thetac118(i)))-thetaa117(i));
    thetaa118(i+1)=thetaa118(i)+h*(-(wj118(i)*wj111(i)*(betaa11*(thetaa111(i)-thetac111(i))+betac11*thetac118(i))+wj111(i)*wj112(i)*(betaa11*(thetaa112(i)-thetac112(i))+betac11*thetac112(i))+...
        wj118(i)*wj113(i)*(betaa11*(thetaa113(i)-thetac113(i))+betac11*thetac113(i))+wj118(i)*wj114(i)*(betaa11*(thetaa114(i)-thetac114(i))+betac11*thetac114(i))+...
        wj118(i)*wj115(i)*(betaa11*(thetaa115(i)-thetac115(i))+betac11*thetac115(i))+wj118(i)*wj116(i)*(betaa11*(thetaa116(i)-thetac116(i))+betac11*thetac116(i))+...
        wj118(i)*wj117(i)*(betaa11*(thetaa117(i)-thetac117(i))+betac11*thetac117(i))+(wj118(i)*wj118(i)+sigmaj11)*(betaa11*(thetaa118(i)-thetac118(i))+betac11*thetac118(i)))-thetaa118(i));
    v110(i)=-lambda110*(abs(psi110(i)-a1(i)))^(1/2)*sign(psi110(i)-a1(i))+psi111(i);
    psi110(i+1)=psi110(i)+h*v110(i);
    psi111(i+1)=psi111(i)+h*(-lambda111*sign(psi111(i)-v110(i)));
    rho1(i+1)=rho1(i)+h*(etarho1*[z1(i)-sin((i-1)*h)-E111(i) z2(i)-cos((i-1)*h)-E112(i)]*P11L*w1(i)...
        -etarho1*deltarho1*rho1(i)-etarho1*rho1(i));
    wf121(i)=exp(-(norm([z1(i);z2(i);z3(i)]-[8;8;8]+(2/3)*[1;1;1]))^2/(2^2));
    wf122(i)=exp(-(norm([z1(i);z2(i);z3(i)]-[8;8;8]+(2/3)*[2;2;2]))^2/(2^2));
    wf123(i)=exp(-(norm([z1(i);z2(i);z3(i)]-[8;8;8]+(2/3)*[3;3;3]))^2/(2^2));
    wf124(i)=exp(-(norm([z1(i);z2(i);z3(i)]-[8;8;8]+(2/3)*[4;4;4]))^2/(2^2));
    wf125(i)=exp(-(norm([z1(i);z2(i);z3(i)]-[8;8;8]+(2/3)*[5;5;5]))^2/(2^2));
    wf126(i)=exp(-(norm([z1(i);z2(i);z3(i)]-[8;8;8]+(2/3)*[6;6;6]))^2/(2^2));
    wf127(i)=exp(-(norm([z1(i);z2(i);z3(i)]-[8;8;8]+(2/3)*[7;7;7]))^2/(2^2));
    wf128(i)=exp(-(norm([z1(i);z2(i);z3(i)]-[8;8;8]+(2/3)*[8;8;8]))^2/(2^2));
    wj121(i)=exp(-(norm([z1(i);z2(i);z3(i);z3(i)-psi110(i)-E121(i);z3(i)-psi110(i);psi111(i)]...
        -[8;8;8;8;8;8]+(2/3)*[1;1;1;1;1;1]))^2/(2^2));
    wj122(i)=exp(-(norm([z1(i);z2(i);z3(i);z3(i)-psi110(i)-E121(i);z3(i)-psi110(i);psi111(i)]...
        -[8;8;8;8;8;8]+(2/3)*[2;2;2;2;2;2]))^2/(2^2));
    wj123(i)=exp(-(norm([z1(i);z2(i);z3(i);z3(i)-psi110(i)-E121(i);z3(i)-psi110(i);psi111(i)]...
        -[8;8;8;8;8;8]+(2/3)*[3;3;3;3;3;3]))^2/(2^2));
    wj124(i)=exp(-(norm([z1(i);z2(i);z3(i);z3(i)-psi110(i)-E121(i);z3(i)-psi110(i);psi111(i)]...
        -[8;8;8;8;8;8]+(2/3)*[4;4;4;4;4;4]))^2/(2^2));
    wj125(i)=exp(-(norm([z1(i);z2(i);z3(i);z3(i)-psi110(i)-E121(i);z3(i)-psi110(i);psi111(i)]...
        -[8;8;8;8;8;8]+(2/3)*[5;5;5;5;5;5]))^2/(2^2));
    wj126(i)=exp(-(norm([z1(i);z2(i);z3(i);z3(i)-psi110(i)-E121(i);z3(i)-psi110(i);psi111(i)]...
        -[8;8;8;8;8;8]+(2/3)*[6;6;6;6;6;6]))^2/(2^2));
    wj127(i)=exp(-(norm([z1(i);z2(i);z3(i);z3(i)-psi110(i)-E121(i);z3(i)-psi110(i);psi111(i)]...
        -[8;8;8;8;8;8]+(2/3)*[7;7;7;7;7;7]))^2/(2^2));
    wj128(i)=exp(-(norm([z1(i);z2(i);z3(i);z3(i)-psi110(i)-E121(i);z3(i)-psi110(i);psi111(i)]...
        -[8;8;8;8;8;8]+(2/3)*[8;8;8;8;8;8]))^2/(2^2));
    thetaf121(i+1)=thetaf121(i)+h*tau12*(wf121(i)*(z3(i)-psi110(i)-E121(i))*P12-sigmaf12*thetaf121(i)-thetaf121(i));
    thetaf122(i+1)=thetaf122(i)+h*tau12*(wf122(i)*(z3(i)-psi110(i)-E121(i))*P12-sigmaf12*thetaf122(i)-thetaf122(i));
    thetaf123(i+1)=thetaf123(i)+h*tau12*(wf123(i)*(z3(i)-psi110(i)-E121(i))*P12-sigmaf12*thetaf123(i)-thetaf123(i));
    thetaf124(i+1)=thetaf124(i)+h*tau12*(wf124(i)*(z3(i)-psi110(i)-E121(i))*P12-sigmaf12*thetaf124(i)-thetaf124(i));
    thetaf125(i+1)=thetaf125(i)+h*tau12*(wf125(i)*(z3(i)-psi110(i)-E121(i))*P12-sigmaf12*thetaf125(i)-thetaf125(i));
    thetaf126(i+1)=thetaf126(i)+h*tau12*(wf126(i)*(z3(i)-psi110(i)-E121(i))*P12-sigmaf12*thetaf126(i)-thetaf126(i));
    thetaf127(i+1)=thetaf127(i)+h*tau12*(wf127(i)*(z3(i)-psi110(i)-E121(i))*P12-sigmaf12*thetaf127(i)-thetaf127(i));
    thetaf128(i+1)=thetaf128(i)+h*tau12*(wf128(i)*(z3(i)-psi110(i)-E121(i))*P12-sigmaf12*thetaf128(i)-thetaf128(i));
    thetac121(i+1)=thetac121(i)+h*(-betac12*((wj121(i)*wj121(i)+sigmaj12)*thetac121(i)+wj121(i)*wj122(i)*thetac122(i)+wj121(i)*wj123(i)*thetac123(i)+...
        wj121(i)*wj124(i)*thetac124(i)+wj121(i)*wj125(i)*thetac125(i)+wj121(i)*wj126(i)*thetac126(i)+wj121(i)*wj127(i)*thetac127(i)+...
        wj121(i)*wj128(i)*thetac128(i))-thetac121(i));
    thetac122(i+1)=thetac122(i)+h*(-betac12*(wj122(i)*wj121(i)*thetac121(i)+(wj122(i)*wj122(i)+sigmaj12)*thetac122(i)+wj122(i)*wj123(i)*thetac123(i)+...
        wj122(i)*wj124(i)*thetac124(i)+wj122(i)*wj125(i)*thetac125(i)+wj122(i)*wj126(i)*thetac126(i)+wj122(i)*wj127(i)*thetac127(i)+...
        wj122(i)*wj128(i)*thetac128(i))-thetac122(i));
    thetac123(i+1)=thetac123(i)+h*(-betac12*(wj123(i)*wj121(i)*thetac121(i)+wj123(i)*wj122(i)*thetac122(i)+(wj123(i)*wj123(i)+sigmaj12)*thetac123(i)+...
        wj123(i)*wj124(i)*thetac124(i)+wj123(i)*wj125(i)*thetac125(i)+wj123(i)*wj126(i)*thetac126(i)+wj123(i)*wj127(i)*thetac127(i)+...
        wj123(i)*wj128(i)*thetac128(i))-thetac123(i));
    thetac124(i+1)=thetac124(i)+h*(-betac12*(wj124(i)*wj121(i)*thetac121(i)+wj124(i)*wj122(i)*thetac122(i)+wj124(i)*wj123(i)*thetac123(i)+...
        (wj124(i)*wj124(i)+sigmaj12)*thetac124(i)+wj124(i)*wj125(i)*thetac125(i)+wj124(i)*wj126(i)*thetac126(i)+wj124(i)*wj127(i)*thetac127(i)+...
        wj124(i)*wj128(i)*thetac128(i))-thetac124(i));
    thetac125(i+1)=thetac125(i)+h*(-betac12*(wj125(i)*wj121(i)*thetac121(i)+wj125(i)*wj122(i)*thetac122(i)+wj125(i)*wj123(i)*thetac123(i)+...
        wj125(i)*wj124(i)*thetac124(i)+(wj125(i)*wj125(i)+sigmaj12)*thetac125(i)+wj125(i)*wj126(i)*thetac126(i)+wj125(i)*wj127(i)*thetac127(i)+...
        wj125(i)*wj128(i)*thetac128(i))-thetac125(i));
    thetac126(i+1)=thetac126(i)+h*(-betac12*(wj126(i)*wj121(i)*thetac121(i)+wj126(i)*wj122(i)*thetac122(i)+wj126(i)*wj123(i)*thetac123(i)+...
        wj126(i)*wj124(i)*thetac124(i)+wj126(i)*wj125(i)*thetac125(i)+(wj126(i)*wj126(i)+sigmaj12)*thetac126(i)+wj126(i)*wj127(i)*thetac127(i)+...
        wj126(i)*wj128(i)*thetac128(i))-thetac126(i));
    thetac127(i+1)=thetac127(i)+h*(-betac12*(wj127(i)*wj121(i)*thetac121(i)+wj127(i)*wj122(i)*thetac122(i)+wj127(i)*wj123(i)*thetac123(i)+...
        wj127(i)*wj124(i)*thetac124(i)+wj127(i)*wj125(i)*thetac125(i)+wj127(i)*wj126(i)*thetac126(i)+(wj127(i)*wj127(i)+sigmaj12)*thetac127(i)+...
        wj127(i)*wj128(i)*thetac128(i))-thetac127(i));
    thetac128(i+1)=thetac128(i)+h*(-betac12*(wj128(i)*wj121(i)*thetac121(i)+wj128(i)*wj122(i)*thetac122(i)+wj128(i)*wj123(i)*thetac123(i)+...
        wj128(i)*wj124(i)*thetac124(i)+wj128(i)*wj125(i)*thetac125(i)+wj128(i)*wj126(i)*thetac126(i)+wj128(i)*wj127(i)*thetac127(i)+...
        (wj128(i)*wj128(i)+sigmaj12)*thetac128(i))-thetac128(i));
   thetaa121(i+1)=thetaa121(i)+h*(-((wj121(i)*wj121(i)+sigmaj12)*(betaa12*(thetaa121(i)-thetac121(i))+betac12*thetac121(i))+wj121(i)*wj122(i)*(betaa12*(thetaa122(i)-thetac122(i))+betac12*thetac122(i))+...
        wj121(i)*wj123(i)*(betaa12*(thetaa123(i)-thetac123(i))+betac12*thetac123(i))+wj121(i)*wj124(i)*(betaa12*(thetaa124(i)-thetac124(i))+betac12*thetac124(i))+...
        wj121(i)*wj125(i)*(betaa12*(thetaa125(i)-thetac125(i))+betac12*thetac125(i))+wj121(i)*wj126(i)*(betaa12*(thetaa126(i)-thetac126(i))+betac12*thetac126(i))+...
        wj121(i)*wj127(i)*(betaa12*(thetaa127(i)-thetac127(i))+betac12*thetac127(i))+wj121(i)*wj128(i)*(betaa12*(thetaa128(i)-thetac128(i))+betac12*thetac128(i)))-thetaa121(i));
   thetaa122(i+1)=thetaa122(i)+h*(-(wj122(i)*wj121(i)*(betaa12*(thetaa121(i)-thetac121(i))+betac12*thetac121(i))+(wj122(i)*wj122(i)+sigmaj12)*(betaa12*(thetaa122(i)-thetac122(i))+betac12*thetac122(i))+...
        wj122(i)*wj123(i)*(betaa12*(thetaa123(i)-thetac123(i))+betac12*thetac123(i))+wj122(i)*wj124(i)*(betaa12*(thetaa124(i)-thetac124(i))+betac12*thetac124(i))+...
        wj122(i)*wj125(i)*(betaa12*(thetaa125(i)-thetac125(i))+betac12*thetac125(i))+wj122(i)*wj126(i)*(betaa12*(thetaa126(i)-thetac126(i))+betac12*thetac126(i))+...
        wj122(i)*wj127(i)*(betaa12*(thetaa127(i)-thetac127(i))+betac12*thetac127(i))+wj122(i)*wj128(i)*(betaa12*(thetaa128(i)-thetac128(i))+betac12*thetac128(i)))-thetaa122(i));
   thetaa123(i+1)=thetaa123(i)+h*(-(wj123(i)*wj121(i)*(betaa12*(thetaa121(i)-thetac121(i))+betac12*thetac121(i))+wj123(i)*wj122(i)*(betaa12*(thetaa122(i)-thetac122(i))+betac12*thetac122(i))+...
        (wj123(i)*wj123(i)+sigmaj12)*(betaa12*(thetaa123(i)-thetac123(i))+betac12*thetac123(i))+wj123(i)*wj124(i)*(betaa12*(thetaa124(i)-thetac124(i))+betac12*thetac124(i))+...
        wj123(i)*wj125(i)*(betaa12*(thetaa125(i)-thetac125(i))+betac12*thetac125(i))+wj123(i)*wj126(i)*(betaa12*(thetaa126(i)-thetac126(i))+betac12*thetac126(i))+...
        wj123(i)*wj127(i)*(betaa12*(thetaa127(i)-thetac127(i))+betac12*thetac127(i))+wj123(i)*wj128(i)*(betaa12*(thetaa128(i)-thetac128(i))+betac12*thetac128(i)))-thetaa123(i));
   thetaa124(i+1)=thetaa124(i)+h*(-(wj124(i)*wj121(i)*(betaa12*(thetaa121(i)-thetac121(i))+betac12*thetac121(i))+wj124(i)*wj122(i)*(betaa12*(thetaa122(i)-thetac122(i))+betac12*thetac122(i))+...
        wj124(i)*wj123(i)*(betaa12*(thetaa123(i)-thetac123(i))+betac12*thetac123(i))+(wj124(i)*wj124(i)+sigmaj12)*(betaa12*(thetaa124(i)-thetac124(i))+betac12*thetac124(i))+...
        wj124(i)*wj125(i)*(betaa12*(thetaa125(i)-thetac125(i))+betac12*thetac125(i))+wj124(i)*wj126(i)*(betaa12*(thetaa126(i)-thetac126(i))+betac12*thetac126(i))+...
        wj124(i)*wj127(i)*(betaa12*(thetaa127(i)-thetac127(i))+betac12*thetac127(i))+wj124(i)*wj128(i)*(betaa12*(thetaa128(i)-thetac128(i))+betac12*thetac128(i)))-thetaa124(i));
   thetaa125(i+1)=thetaa125(i)+h*(-(wj125(i)*wj121(i)*(betaa12*(thetaa121(i)-thetac121(i))+betac12*thetac121(i))+wj125(i)*wj122(i)*(betaa12*(thetaa122(i)-thetac122(i))+betac12*thetac122(i))+...
        wj125(i)*wj123(i)*(betaa12*(thetaa123(i)-thetac123(i))+betac12*thetac123(i))+wj125(i)*wj124(i)*(betaa12*(thetaa124(i)-thetac124(i))+betac12*thetac124(i))+...
        (wj125(i)*wj125(i)+sigmaj12)*(betaa12*(thetaa125(i)-thetac125(i))+betac12*thetac125(i))+wj125(i)*wj126(i)*(betaa12*(thetaa126(i)-thetac126(i))+betac12*thetac126(i))+...
        wj125(i)*wj127(i)*(betaa12*(thetaa127(i)-thetac127(i))+betac12*thetac127(i))+wj125(i)*wj128(i)*(betaa12*(thetaa128(i)-thetac128(i))+betac12*thetac128(i)))-thetaa125(i));
   thetaa126(i+1)=thetaa126(i)+h*(-(wj126(i)*wj121(i)*(betaa12*(thetaa121(i)-thetac121(i))+betac12*thetac121(i))+wj126(i)*wj122(i)*(betaa12*(thetaa122(i)-thetac122(i))+betac12*thetac122(i))+...
        wj121(i)*wj123(i)*(betaa12*(thetaa123(i)-thetac123(i))+betac12*thetac123(i))+wj126(i)*wj124(i)*(betaa12*(thetaa124(i)-thetac124(i))+betac12*thetac124(i))+...
        wj126(i)*wj125(i)*(betaa12*(thetaa125(i)-thetac125(i))+betac12*thetac125(i))+(wj126(i)*wj126(i)+sigmaj12)*(betaa12*(thetaa126(i)-thetac126(i))+betac12*thetac126(i))+...
        wj126(i)*wj127(i)*(betaa12*(thetaa127(i)-thetac127(i))+betac12*thetac127(i))+wj126(i)*wj128(i)*(betaa12*(thetaa128(i)-thetac128(i))+betac12*thetac128(i)))-thetaa126(i));
   thetaa127(i+1)=thetaa127(i)+h*(-(wj127(i)*wj121(i)*(betaa12*(thetaa121(i)-thetac121(i))+betac12*thetac121(i))+wj127(i)*wj122(i)*(betaa12*(thetaa122(i)-thetac122(i))+betac12*thetac122(i))+...
        wj127(i)*wj123(i)*(betaa12*(thetaa123(i)-thetac123(i))+betac12*thetac123(i))+wj127(i)*wj124(i)*(betaa12*(thetaa124(i)-thetac124(i))+betac12*thetac124(i))+...
        wj127(i)*wj125(i)*(betaa12*(thetaa125(i)-thetac125(i))+betac12*thetac125(i))+wj127(i)*wj126(i)*(betaa12*(thetaa126(i)-thetac126(i))+betac12*thetac126(i))+...
        (wj127(i)*wj127(i)+sigmaj12)*(betaa12*(thetaa127(i)-thetac127(i))+betac12*thetac127(i))+wj127(i)*wj128(i)*(betaa12*(thetaa128(i)-thetac128(i))+betac12*thetac128(i)))-thetaa127(i));
   thetaa128(i+1)=thetaa128(i)+h*(-(wj128(i)*wj121(i)*(betaa12*(thetaa121(i)-thetac121(i))+betac12*thetac121(i))+wj128(i)*wj122(i)*(betaa12*(thetaa122(i)-thetac122(i))+betac12*thetac122(i))+...
        wj128(i)*wj123(i)*(betaa12*(thetaa123(i)-thetac123(i))+betac12*thetac123(i))+wj128(i)*wj124(i)*(betaa12*(thetaa124(i)-thetac124(i))+betac12*thetac124(i))+...
        wj128(i)*wj125(i)*(betaa12*(thetaa125(i)-thetac125(i))+betac12*thetac125(i))+wj128(i)*wj126(i)*(betaa12*(thetaa126(i)-thetac126(i))+betac12*thetac126(i))+...
        wj128(i)*wj127(i)*(betaa12*(thetaa127(i)-thetac127(i))+betac12*thetac127(i))+(wj128(i)*wj128(i)+sigmaj12)*(betaa12*(thetaa128(i)-thetac128(i))+betac12*thetac128(i)))-thetaa128(i));
    u1(i)=-A12.*(z3(i)-psi110(i))+A12.*phi12.*((z3(i)-psi110(i)-E121(i))^r)+psi111(i)-(thetaf121(i)*wf121(i)+thetaf122(i)*wf122(i)+thetaf123(i)*wf123(i)...
        +thetaf124(i)*wf124(i)+thetaf125(i)*wf125(i)+thetaf126(i)*wf126(i)+thetaf127(i)*wf127(i)+thetaf128(i)*wf128(i))-0.5*(thetaa121(i)*wj121(i)+thetaa122(i)*wj122(i)...
        +thetaa123(i)*wj123(i)+thetaa124(i)*wj124(i)+thetaa125(i)*wj125(i)+thetaa126(i)*wj126(i)+thetaa127(i)*wj127(i)+thetaa128(i)*wj128(i));
    wf211(i)=exp(-(norm([p1(i);p2(i)]-[8.5;8.5]+[1;1]))^2/(2^2));
    wf212(i)=exp(-(norm([p1(i);p2(i)]-[8.5;8.5]+[2;2]))^2/(2^2));
    wf213(i)=exp(-(norm([p1(i);p2(i)]-[8.5;8.5]+[3;3]))^2/(2^2));
    wf214(i)=exp(-(norm([p1(i);p2(i)]-[8.5;8.5]+[4;4]))^2/(2^2));
    wf215(i)=exp(-(norm([p1(i);p2(i)]-[8.5;8.5]+[5;5]))^2/(2^2));
    wf216(i)=exp(-(norm([p1(i);p2(i)]-[8.5;8.5]+[6;6]))^2/(2^2));
    wf217(i)=exp(-(norm([p1(i);p2(i)]-[8.5;8.5]+[7;7]))^2/(2^2));
    wf218(i)=exp(-(norm([p1(i);p2(i)]-[8.5;8.5]+[8;8]))^2/(2^2));
    wj211(i)=exp(-(norm([p1(i);p2(i);p1(i)-0.5*sin((i-1)*h)-0.5*sin(0.5*(i-1)*h)-E211(i);p1(i)-0.5*sin((i-1)*h)-0.5*sin(0.5*(i-1)*h);p2(i)-0.5*cos((i-1)*h)-0.25*cos(0.5*(i-1)*h);...
        -0.5*sin((i-1)*h)-0.125*sin(0.5*(i-1)*h);p2(i)-0.5*cos((i-1)*h)-0.25*cos(0.5*(i-1)*h)-E212(i)]-[8.5;8.5;8.5;8.5;8.5;8.5;8.5]+[1;1;1;1;1;1;1]))^2/(2^2));
    wj212(i)=exp(-(norm([p1(i);p2(i);p1(i)-0.5*sin((i-1)*h)-0.5*sin(0.5*(i-1)*h)-E211(i);p1(i)-0.5*sin((i-1)*h)-0.5*sin(0.5*(i-1)*h);p2(i)-0.5*cos((i-1)*h)-0.25*cos(0.5*(i-1)*h);...
        -0.5*sin((i-1)*h)-0.125*sin(0.5*(i-1)*h);p2(i)-0.5*cos((i-1)*h)-0.25*cos(0.5*(i-1)*h)-E212(i)]-[8.5;8.5;8.5;8.5;8.5;8.5;8.5]+[2;2;2;2;2;2;2]))^2/(2^2));
    wj213(i)=exp(-(norm([p1(i);p2(i);p1(i)-0.5*sin((i-1)*h)-0.5*sin(0.5*(i-1)*h)-E211(i);p1(i)-0.5*sin((i-1)*h)-0.5*sin(0.5*(i-1)*h);p2(i)-0.5*cos((i-1)*h)-0.25*cos(0.5*(i-1)*h);...
        -0.5*sin((i-1)*h)-0.125*sin(0.5*(i-1)*h);p2(i)-0.5*cos((i-1)*h)-0.25*cos(0.5*(i-1)*h)-E212(i)]-[8.5;8.5;8.5;8.5;8.5;8.5;8.5]+[3;3;3;3;3;3;3]))^2/(2^2));
    wj214(i)=exp(-(norm([p1(i);p2(i);p1(i)-0.5*sin((i-1)*h)-0.5*sin(0.5*(i-1)*h)-E211(i);p1(i)-0.5*sin((i-1)*h)-0.5*sin(0.5*(i-1)*h);p2(i)-0.5*cos((i-1)*h)-0.25*cos(0.5*(i-1)*h);...
        -0.5*sin((i-1)*h)-0.125*sin(0.5*(i-1)*h);p2(i)-0.5*cos((i-1)*h)-0.25*cos(0.5*(i-1)*h)-E212(i)]-[8.5;8.5;8.5;8.5;8.5;8.5;8.5]+[4;4;4;4;4;4;4]))^2/(2^2));
    wj215(i)=exp(-(norm([p1(i);p2(i);p1(i)-0.5*sin((i-1)*h)-0.5*sin(0.5*(i-1)*h)-E211(i);p1(i)-0.5*sin((i-1)*h)-0.5*sin(0.5*(i-1)*h);p2(i)-0.5*cos((i-1)*h)-0.25*cos(0.5*(i-1)*h);...
        -0.5*sin((i-1)*h)-0.125*sin(0.5*(i-1)*h);p2(i)-0.5*cos((i-1)*h)-0.25*cos(0.5*(i-1)*h)-E212(i)]-[8.5;8.5;8.5;8.5;8.5;8.5;8.5]+[5;5;5;5;5;5;5]))^2/(2^2));
    wj216(i)=exp(-(norm([p1(i);p2(i);p1(i)-0.5*sin((i-1)*h)-0.5*sin(0.5*(i-1)*h)-E211(i);p1(i)-0.5*sin((i-1)*h)-0.5*sin(0.5*(i-1)*h);p2(i)-0.5*cos((i-1)*h)-0.25*cos(0.5*(i-1)*h);...
        -0.5*sin((i-1)*h)-0.125*sin(0.5*(i-1)*h);p2(i)-0.5*cos((i-1)*h)-0.25*cos(0.5*(i-1)*h)-E212(i)]-[8.5;8.5;8.5;8.5;8.5;8.5;8.5]+[6;6;6;6;6;6;6]))^2/(2^2));
    wj217(i)=exp(-(norm([p1(i);p2(i);p1(i)-0.5*sin((i-1)*h)-0.5*sin(0.5*(i-1)*h)-E211(i);p1(i)-0.5*sin((i-1)*h)-0.5*sin(0.5*(i-1)*h);p2(i)-0.5*cos((i-1)*h)-0.25*cos(0.5*(i-1)*h);...
        -0.5*sin((i-1)*h)-0.125*sin(0.5*(i-1)*h);p2(i)-0.5*cos((i-1)*h)-0.25*cos(0.5*(i-1)*h)-E212(i)]-[8.5;8.5;8.5;8.5;8.5;8.5;8.5]+[7;7;7;7;7;7;7]))^2/(2^2));
    wj218(i)=exp(-(norm([p1(i);p2(i);p1(i)-0.5*sin((i-1)*h)-0.5*sin(0.5*(i-1)*h)-E211(i);p1(i)-0.5*sin((i-1)*h)-0.5*sin(0.5*(i-1)*h);p2(i)-0.5*cos((i-1)*h)-0.25*cos(0.5*(i-1)*h);...
        -0.5*sin((i-1)*h)-0.125*sin(0.5*(i-1)*h);p2(i)-0.5*cos((i-1)*h)-0.25*cos(0.5*(i-1)*h)-E212(i)]-[8.5;8.5;8.5;8.5;8.5;8.5;8.5]+[8;8;8;8;8;8;8]))^2/(2^2));
    w2(i)=(2*transpose(P21L)*[p1(i)-0.5*sin((i-1)*h)-0.5*sin(0.5*(i-1)*h)-E211(i);p2(i)-0.5*cos((i-1)*h)-0.25*cos(0.5*(i-1)*h)-E212(i)])*H112(z1(i))/...
        ((transpose(P21L)*[p1(i)-0.5*sin((i-1)*h)-0.5*sin(0.5*(i-1)*h)-E211(i);p2(i)-0.5*cos((i-1)*h)-0.25*cos(0.5*(i-1)*h)-E212(i)])*...
        (transpose(P21L)*[p1(i)-0.5*sin((i-1)*h)-0.5*sin(0.5*(i-1)*h)-E211(i);p2(i)-0.5*cos((i-1)*h)-0.25*cos(0.5*(i-1)*h)-E212(i)])+psi2);
    a2(i)=-A21*[p1(i)-0.5*sin((i-1)*h)-0.5*sin(0.5*(i-1)*h);p2(i)-0.5*cos((i-1)*h)-0.25*cos(0.5*(i-1)*h)]+A21*phi21*[(p1(i)-0.5*sin((i-1)*h)-0.5*sin(0.5*(i-1)*h)-E211(i))^r;...
        (p2(i)-0.5*cos((i-1)*h)-0.25*cos(0.5*(i-1)*h)-E212(i))^r]-0.5*sin((i-1)*h)-0.125*sin(0.5*(i-1)*h)-(thetaf211(i)*wj211(i)+thetaf212(i)*wj212(i)+thetaf213(i)*wj213(i)...
        +thetaf214(i)*wj214(i)+thetaf215(i)*wj215(i)+thetaf216(i)*wj216(i)+thetaf217(i)*wj217(i)+thetaf218(i)*wj218(i))...
        -0.5*(thetaa211(i)*wj211(i)+thetaa212(i)*wj212(i)+thetaa213(i)*wj213(i)+thetaa214(i)*wj214(i)+thetaa215(i)*wj215(i)...
        +thetaa216(i)*wj216(i)+thetaa217(i)*wj217(i)+thetaa218(i)*wj218(i))-rho2(i)*w2(i);
   E211(i+1)=E211(i)+h*E212(i);
   E212(i+1)=E212(i)+h*(-A21*[E211(i);E212(i)]+E221(i)+(psi210(i)-a2(i))-l211*sign(E211(i))...
        -l212*sign(E212(i)));
   E221(i+1)=E221(i)+h*(-A22*E221(i)-l221*sign(E221(i)));
    thetaf211(i+1)=thetaf211(i)+h*tau21*(wf211(i)*[p1(i)-0.5*sin((i-1)*h)-0.5*sin(0.5*(i-1)*h)-E211(i) p2(i)-0.5*cos((i-1)*h)-0.25*cos(0.5*(i-1)*h)-E212(i)]*P21L...
        -sigmaf21*thetaf211(i)-thetaf211(i));
    thetaf212(i+1)=thetaf212(i)+h*tau21*(wf212(i)*[p1(i)-0.5*sin((i-1)*h)-0.5*sin(0.5*(i-1)*h)-E211(i) p2(i)-0.5*cos((i-1)*h)-0.25*cos(0.5*(i-1)*h)-E212(i)]*P21L...
        -sigmaf21*thetaf212(i)-thetaf212(i));
    thetaf213(i+1)=thetaf213(i)+h*tau21*(wf213(i)*[p1(i)-0.5*sin((i-1)*h)-0.5*sin(0.5*(i-1)*h)-E211(i) p2(i)-0.5*cos((i-1)*h)-0.25*cos(0.5*(i-1)*h)-E212(i)]*P21L...
        -sigmaf21*thetaf213(i)-thetaf213(i));
    thetaf214(i+1)=thetaf214(i)+h*tau21*(wf214(i)*[p1(i)-0.5*sin((i-1)*h)-0.5*sin(0.5*(i-1)*h)-E211(i) p2(i)-0.5*cos((i-1)*h)-0.25*cos(0.5*(i-1)*h)-E212(i)]*P21L...
        -sigmaf21*thetaf214(i)-thetaf214(i));
    thetaf215(i+1)=thetaf215(i)+h*tau21*(wf215(i)*[p1(i)-0.5*sin((i-1)*h)-0.5*sin(0.5*(i-1)*h)-E211(i) p2(i)-0.5*cos((i-1)*h)-0.25*cos(0.5*(i-1)*h)-E212(i)]*P21L...
        -sigmaf21*thetaf215(i)-thetaf215(i));
    thetaf216(i+1)=thetaf216(i)+h*tau21*(wf216(i)*[p1(i)-0.5*sin((i-1)*h)-0.5*sin(0.5*(i-1)*h)-E211(i) p2(i)-0.5*cos((i-1)*h)-0.25*cos(0.5*(i-1)*h)-E212(i)]*P21L...
        -sigmaf21*thetaf216(i)-thetaf216(i));
    thetaf217(i+1)=thetaf217(i)+h*tau21*(wf217(i)*[p1(i)-0.5*sin((i-1)*h)-0.5*sin(0.5*(i-1)*h)-E211(i) p2(i)-0.5*cos((i-1)*h)-0.25*cos(0.5*(i-1)*h)-E212(i)]*P21L...
        -sigmaf21*thetaf217(i)-thetaf217(i));
    thetaf218(i+1)=thetaf218(i)+h*tau21*(wf218(i)*[p1(i)-0.5*sin((i-1)*h)-0.5*sin(0.5*(i-1)*h)-E211(i) p2(i)-0.5*cos((i-1)*h)-0.25*cos(0.5*(i-1)*h)-E212(i)]*P21L...
        -sigmaf21*thetaf218(i)-thetaf218(i));
    thetac211(i+1)=thetac211(i)+h*(-betac21*((wj211(i)*wj211(i)+sigmaj21)*thetac211(i)+wj211(i)*wj212(i)*thetac212(i)+wj211(i)*wj213(i)*thetac213(i)+...
        wj211(i)*wj214(i)*thetac214(i)+wj211(i)*wj215(i)*thetac215(i)+wj211(i)*wj216(i)*thetac216(i)+wj211(i)*wj217(i)*thetac217(i)+...
        wj211(i)*wj218(i)*thetac218(i))-thetac211(i));
    thetac212(i+1)=thetac212(i)+h*(-betac21*(wj212(i)*wj211(i)*thetac211(i)+(wj212(i)*wj212(i)+sigmaj21)*thetac212(i)+wj212(i)*wj213(i)*thetac213(i)+...
        wj212(i)*wj214(i)*thetac214(i)+wj212(i)*wj215(i)*thetac215(i)+wj212(i)*wj216(i)*thetac216(i)+wj212(i)*wj217(i)*thetac217(i)+...
        wj212(i)*wj218(i)*thetac218(i))-thetac212(i));
    thetac213(i+1)=thetac213(i)+h*(-betac21*(wj213(i)*wj211(i)*thetac211(i)+wj213(i)*wj212(i)*thetac212(i)+(wj213(i)*wj213(i)+sigmaj21)*thetac213(i)+...
        wj213(i)*wj214(i)*thetac214(i)+wj213(i)*wj215(i)*thetac215(i)+wj213(i)*wj216(i)*thetac216(i)+wj213(i)*wj217(i)*thetac217(i)+...
        wj213(i)*wj218(i)*thetac218(i))-thetac213(i));
    thetac214(i+1)=thetac214(i)+h*(-betac21*(wj214(i)*wj211(i)*thetac211(i)+wj214(i)*wj212(i)*thetac212(i)+wj214(i)*wj213(i)*thetac213(i)+...
        (wj214(i)*wj214(i)+sigmaj21)*thetac214(i)+wj214(i)*wj215(i)*thetac215(i)+wj214(i)*wj216(i)*thetac216(i)+wj214(i)*wj217(i)*thetac217(i)+...
        wj214(i)*wj218(i)*thetac218(i))-thetac214(i));
    thetac215(i+1)=thetac215(i)+h*(-betac21*(wj215(i)*wj211(i)*thetac211(i)+wj215(i)*wj212(i)*thetac212(i)+wj215(i)*wj213(i)*thetac213(i)+...
        wj215(i)*wj214(i)*thetac214(i)+(wj215(i)*wj215(i)+sigmaj21)*thetac215(i)+wj215(i)*wj216(i)*thetac216(i)+wj215(i)*wj217(i)*thetac217(i)+...
        wj215(i)*wj218(i)*thetac218(i))-thetac215(i));
    thetac216(i+1)=thetac216(i)+h*(-betac21*(wj216(i)*wj211(i)*thetac211(i)+wj216(i)*wj212(i)*thetac212(i)+wj216(i)*wj213(i)*thetac213(i)+...
        wj216(i)*wj214(i)*thetac214(i)+wj216(i)*wj215(i)*thetac215(i)+(wj216(i)*wj216(i)+sigmaj21)*thetac216(i)+wj216(i)*wj217(i)*thetac217(i)+...
        wj216(i)*wj218(i)*thetac218(i))-thetac216(i));
    thetac217(i+1)=thetac217(i)+h*(-betac21*(wj217(i)*wj211(i)*thetac211(i)+wj217(i)*wj212(i)*thetac212(i)+wj217(i)*wj213(i)*thetac213(i)+...
        wj217(i)*wj214(i)*thetac214(i)+wj217(i)*wj215(i)*thetac215(i)+wj217(i)*wj216(i)*thetac216(i)+(wj217(i)*wj217(i)+sigmaj21)*thetac217(i)+...
        wj217(i)*wj218(i)*thetac218(i))-thetac217(i));
    thetac218(i+1)=thetac218(i)+h*(-betac21*(wj218(i)*wj211(i)*thetac211(i)+wj218(i)*wj212(i)*thetac212(i)+wj218(i)*wj213(i)*thetac213(i)+...
        wj218(i)*wj214(i)*thetac214(i)+wj218(i)*wj215(i)*thetac215(i)+wj218(i)*wj216(i)*thetac216(i)+wj218(i)*wj217(i)*thetac217(i)+...
        (wj218(i)*wj218(i)+sigmaj21)*thetac218(i))-thetac218(i));
   thetaa211(i+1)=thetaa211(i)+h*(-((wj211(i)*wj211(i)+sigmaj21)*(betaa21*(thetaa211(i)-thetac211(i))+betac21*thetac211(i))+wj211(i)*wj212(i)*(betaa21*(thetaa212(i)-thetac212(i))+betac21*thetac212(i))+...
        wj211(i)*wj213(i)*(betaa21*(thetaa213(i)-thetac213(i))+betac21*thetac213(i))+wj211(i)*wj214(i)*(betaa21*(thetaa214(i)-thetac214(i))+betac21*thetac214(i))+...
        wj211(i)*wj215(i)*(betaa21*(thetaa215(i)-thetac215(i))+betac21*thetac215(i))+wj211(i)*wj216(i)*(betaa21*(thetaa216(i)-thetac216(i))+betac21*thetac216(i))+...
        wj211(i)*wj217(i)*(betaa21*(thetaa217(i)-thetac217(i))+betac21*thetac217(i))+wj211(i)*wj218(i)*(betaa21*(thetaa218(i)-thetac218(i))+betac21*thetac218(i)))-thetaa211(i));
   thetaa212(i+1)=thetaa212(i)+h*(-(wj212(i)*wj211(i)*(betaa21*(thetaa211(i)-thetac211(i))+betac21*thetac211(i))+(wj212(i)*wj212(i)+sigmaj21)*(betaa21*(thetaa212(i)-thetac212(i))+betac21*thetac212(i))+...
        wj212(i)*wj213(i)*(betaa21*(thetaa213(i)-thetac213(i))+betac21*thetac213(i))+wj212(i)*wj214(i)*(betaa21*(thetaa214(i)-thetac214(i))+betac21*thetac214(i))+...
        wj212(i)*wj215(i)*(betaa21*(thetaa215(i)-thetac215(i))+betac21*thetac215(i))+wj212(i)*wj216(i)*(betaa21*(thetaa216(i)-thetac216(i))+betac21*thetac216(i))+...
        wj212(i)*wj217(i)*(betaa21*(thetaa217(i)-thetac217(i))+betac21*thetac217(i))+wj212(i)*wj218(i)*(betaa21*(thetaa218(i)-thetac218(i))+betac21*thetac218(i)))-thetaa212(i));
    thetaa213(i+1)=thetaa213(i)+h*(-(wj213(i)*wj211(i)*(betaa21*(thetaa211(i)-thetac211(i))+betac21*thetac211(i))+wj213(i)*wj212(i)*(betaa21*(thetaa212(i)-thetac212(i))+betac21*thetac212(i))+...
        (wj213(i)*wj213(i)+sigmaj21)*(betaa21*(thetaa213(i)-thetac213(i))+betac21*thetac213(i))+wj213(i)*wj214(i)*(betaa21*(thetaa214(i)-thetac214(i))+betac21*thetac214(i))+...
        wj213(i)*wj215(i)*(betaa21*(thetaa215(i)-thetac215(i))+betac21*thetac215(i))+wj213(i)*wj216(i)*(betaa21*(thetaa216(i)-thetac216(i))+betac21*thetac216(i))+...
        wj213(i)*wj217(i)*(betaa21*(thetaa217(i)-thetac217(i))+betac21*thetac217(i))+wj213(i)*wj218(i)*(betaa21*(thetaa218(i)-thetac218(i))+betac21*thetac218(i)))-thetaa213(i));
    thetaa214(i+1)=thetaa214(i)+h*(-(wj214(i)*wj211(i)*(betaa21*(thetaa211(i)-thetac211(i))+betac21*thetac211(i))+wj214(i)*wj212(i)*(betaa21*(thetaa212(i)-thetac212(i))+betac21*thetac212(i))+...
        wj214(i)*wj213(i)*(betaa21*(thetaa213(i)-thetac213(i))+betac21*thetac213(i))+(wj214(i)*wj214(i)+sigmaj21)*(betaa21*(thetaa214(i)-thetac214(i))+betac21*thetac214(i))+...
        wj214(i)*wj215(i)*(betaa21*(thetaa215(i)-thetac215(i))+betac21*thetac215(i))+wj214(i)*wj216(i)*(betaa21*(thetaa216(i)-thetac216(i))+betac21*thetac216(i))+...
        wj214(i)*wj217(i)*(betaa21*(thetaa217(i)-thetac217(i))+betac21*thetac217(i))+wj214(i)*wj218(i)*(betaa21*(thetaa218(i)-thetac218(i))+betac21*thetac218(i)))-thetaa214(i));
    thetaa215(i+1)=thetaa215(i)+h*(-(wj215(i)*wj211(i)*(betaa21*(thetaa211(i)-thetac211(i))+betac21*thetac211(i))+wj215(i)*wj212(i)*(betaa21*(thetaa212(i)-thetac212(i))+betac21*thetac212(i))+...
        wj215(i)*wj213(i)*(betaa21*(thetaa213(i)-thetac213(i))+betac21*thetac213(i))+wj215(i)*wj214(i)*(betaa21*(thetaa214(i)-thetac214(i))+betac21*thetac214(i))+...
        (wj215(i)*wj215(i)+sigmaj21)*(betaa21*(thetaa215(i)-thetac215(i))+betac21*thetac215(i))+wj215(i)*wj216(i)*(betaa21*(thetaa216(i)-thetac216(i))+betac21*thetac216(i))+...
        wj215(i)*wj217(i)*(betaa21*(thetaa217(i)-thetac217(i))+betac21*thetac217(i))+wj215(i)*wj218(i)*(betaa21*(thetaa218(i)-thetac218(i))+betac21*thetac218(i)))-thetaa215(i));
    thetaa216(i+1)=thetaa216(i)+h*(-(wj216(i)*wj211(i)*(betaa21*(thetaa211(i)-thetac211(i))+betac21*thetac211(i))+wj216(i)*wj212(i)*(betaa21*(thetaa212(i)-thetac212(i))+betac21*thetac212(i))+...
        wj216(i)*wj213(i)*(betaa21*(thetaa213(i)-thetac213(i))+betac21*thetac213(i))+wj216(i)*wj214(i)*(betaa21*(thetaa214(i)-thetac214(i))+betac21*thetac214(i))+...
        wj216(i)*wj215(i)*(betaa21*(thetaa215(i)-thetac215(i))+betac21*thetac215(i))+(wj216(i)*wj216(i)+sigmaj21)*(betaa21*(thetaa216(i)-thetac216(i))+betac21*thetac216(i))+...
        wj216(i)*wj217(i)*(betaa21*(thetaa217(i)-thetac217(i))+betac21*thetac217(i))+wj216(i)*wj218(i)*(betaa21*(thetaa218(i)-thetac218(i))+betac21*thetac218(i)))-thetaa216(i));
    thetaa217(i+1)=thetaa217(i)+h*(-(wj217(i)*wj211(i)*(betaa21*(thetaa211(i)-thetac211(i))+betac21*thetac211(i))+wj217(i)*wj212(i)*(betaa21*(thetaa212(i)-thetac212(i))+betac21*thetac212(i))+...
        wj217(i)*wj213(i)*(betaa21*(thetaa213(i)-thetac213(i))+betac21*thetac213(i))+wj217(i)*wj214(i)*(betaa21*(thetaa214(i)-thetac214(i))+betac21*thetac214(i))+...
        wj217(i)*wj215(i)*(betaa21*(thetaa215(i)-thetac215(i))+betac21*thetac215(i))+wj217(i)*wj216(i)*(betaa21*(thetaa216(i)-thetac216(i))+betac21*thetac216(i))+...
        (wj217(i)*wj217(i)+sigmaj21)*(betaa21*(thetaa217(i)-thetac217(i))+betac21*thetac217(i))+wj217(i)*wj218(i)*(betaa21*(thetaa218(i)-thetac218(i))+betac21*thetac218(i)))-thetaa217(i));
    thetaa218(i+1)=thetaa218(i)+h*(-(wj218(i)*wj211(i)*(betaa21*(thetaa211(i)-thetac211(i))+betac21*thetac211(i))+wj218(i)*wj212(i)*(betaa21*(thetaa212(i)-thetac212(i))+betac21*thetac212(i))+...
        wj218(i)*wj213(i)*(betaa21*(thetaa213(i)-thetac213(i))+betac21*thetac213(i))+wj218(i)*wj214(i)*(betaa21*(thetaa214(i)-thetac214(i))+betac21*thetac214(i))+...
        wj218(i)*wj215(i)*(betaa21*(thetaa215(i)-thetac215(i))+betac21*thetac215(i))+wj218(i)*wj216(i)*(betaa21*(thetaa216(i)-thetac216(i))+betac21*thetac216(i))+...
        wj218(i)*wj217(i)*(betaa21*(thetaa217(i)-thetac217(i))+betac21*thetac217(i))+(wj218(i)*wj218(i)+sigmaj21)*(betaa21*(thetaa218(i)-thetac218(i))+betac21*thetac218(i)))-thetaa218(i));
    v210(i)=-lambda210*(abs(psi210(i)-a2(i)))^(1/2)*sign(psi210(i)-a2(i))+psi211(i);
    psi210(i+1)=psi210(i)+h*v210(i);
    psi211(i+1)=-lambda211*sign(psi211(i)-v210(i));
    rho2(i+1)=rho2(i)+h*(etarho2*[p1(i)-0.5*sin((i-1)*h)-0.5*sin(0.5*(i-1)*h)-E211(i) p2(i)-0.5*cos((i-1)*h)-0.25*cos(0.5*(i-1)*h)-E212(i)]*P21L*w2(i)...
        -etarho2*deltarho2*rho2(i)-etarho2*rho2(i));
    wf221(i)=exp(-(norm([p1(i);p2(i);p3(i)]-[8;8;8]+(2/3)*[1;1;1]))^2/(2^2));
    wf222(i)=exp(-(norm([p1(i);p2(i);p3(i)]-[8;8;8]+(2/3)*[2;2;2]))^2/(2^2));
    wf223(i)=exp(-(norm([p1(i);p2(i);p3(i)]-[8;8;8]+(2/3)*[3;3;3]))^2/(2^2));
    wf224(i)=exp(-(norm([p1(i);p2(i);p3(i)]-[8;8;8]+(2/3)*[4;4;4]))^2/(2^2));
    wf225(i)=exp(-(norm([p1(i);p2(i);p3(i)]-[8;8;8]+(2/3)*[5;5;5]))^2/(2^2));
    wf226(i)=exp(-(norm([p1(i);p2(i);p3(i)]-[8;8;8]+(2/3)*[6;6;6]))^2/(2^2));
    wf227(i)=exp(-(norm([p1(i);p2(i);p3(i)]-[8;8;8]+(2/3)*[7;7;7]))^2/(2^2));
    wf228(i)=exp(-(norm([p1(i);p2(i);p3(i)]-[8;8;8]+(2/3)*[8;8;8]))^2/(2^2));
    wj221(i)=exp(-(norm([p1(i);p2(i);p3(i);p3(i)-psi210(i)-E221(i);p3(i)-psi210(i);psi211(i)]...
        -[8;8;8;8;8;8]+(2/3)*[1;1;1;1;1;1]))^2/(2^2));
    wj222(i)=exp(-(norm([p1(i);p2(i);p3(i);p3(i)-psi210(i)-E221(i);p3(i)-psi210(i);psi211(i)]...
        -[8;8;8;8;8;8]+(2/3)*[2;2;2;2;2;2]))^2/(2^2));
    wj223(i)=exp(-(norm([p1(i);p2(i);p3(i);p3(i)-psi210(i)-E221(i);p3(i)-psi210(i);psi211(i)]...
        -[8;8;8;8;8;8]+(2/3)*[3;3;3;3;3;3]))^2/(2^2));
    wj224(i)=exp(-(norm([p1(i);p2(i);p3(i);p3(i)-psi210(i)-E221(i);p3(i)-psi210(i);psi211(i)]...
        -[8;8;8;8;8;8]+(2/3)*[4;4;4;4;4;4]))^2/(2^2));
    wj225(i)=exp(-(norm([p1(i);p2(i);p3(i);p3(i)-psi210(i)-E221(i);p3(i)-psi210(i);psi211(i)]...
        -[8;8;8;8;8;8]+(2/3)*[5;5;5;5;5;5]))^2/(2^2));
    wj226(i)=exp(-(norm([p1(i);p2(i);p3(i);p3(i)-psi210(i)-E221(i);p3(i)-psi210(i);psi211(i)]...
        -[8;8;8;8;8;8]+(2/3)*[6;6;6;6;6;6]))^2/(2^2));
    wj227(i)=exp(-(norm([p1(i);p2(i);p3(i);p3(i)-psi210(i)-E221(i);p3(i)-psi210(i);psi211(i)]...
        -[8;8;8;8;8;8]+(2/3)*[7;7;7;7;7;7]))^2/(2^2));
    wj228(i)=exp(-(norm([p1(i);p2(i);p3(i);p3(i)-psi210(i)-E221(i);p3(i)-psi210(i);psi211(i)]...
        -[8;8;8;8;8;8]+(2/3)*[8;8;8;8;8;8]))^2/(2^2));
    thetaf221(i+1)=thetaf221(i)+h*tau22*(wf221(i)*(p3(i)-psi210(i)-E221(i))*P22-sigmaf22*thetaf221(i)-thetaf221(i));
    thetaf222(i+1)=thetaf222(i)+h*tau22*(wf222(i)*(p3(i)-psi210(i)-E221(i))*P22-sigmaf22*thetaf222(i)-thetaf222(i));
    thetaf223(i+1)=thetaf223(i)+h*tau22*(wf223(i)*(p3(i)-psi210(i)-E221(i))*P22-sigmaf22*thetaf223(i)-thetaf223(i));
    thetaf224(i+1)=thetaf224(i)+h*tau22*(wf224(i)*(p3(i)-psi210(i)-E221(i))*P22-sigmaf22*thetaf224(i)-thetaf224(i));
    thetaf225(i+1)=thetaf225(i)+h*tau22*(wf225(i)*(p3(i)-psi210(i)-E221(i))*P22-sigmaf22*thetaf225(i)-thetaf225(i));
    thetaf226(i+1)=thetaf226(i)+h*tau22*(wf226(i)*(p3(i)-psi210(i)-E221(i))*P22-sigmaf22*thetaf226(i)-thetaf226(i));
    thetaf227(i+1)=thetaf227(i)+h*tau22*(wf227(i)*(p3(i)-psi210(i)-E221(i))*P22-sigmaf22*thetaf227(i)-thetaf227(i));
    thetaf228(i+1)=thetaf228(i)+h*tau22*(wf228(i)*(p3(i)-psi210(i)-E221(i))*P22-sigmaf22*thetaf228(i)-thetaf228(i));
    thetac221(i+1)=thetac221(i)+h*(-betac22*((wj221(i)*wj221(i)+sigmaj22)*thetac221(i)+wj221(i)*wj222(i)*thetac222(i)+wj221(i)*wj223(i)*thetac223(i)+...
        wj221(i)*wj224(i)*thetac224(i)+wj221(i)*wj225(i)*thetac225(i)+wj221(i)*wj226(i)*thetac226(i)+wj221(i)*wj227(i)*thetac227(i)+...
        wj221(i)*wj228(i)*thetac228(i))-thetac221(i));
    thetac222(i+1)=thetac222(i)+h*(-betac22*(wj222(i)*wj221(i)*thetac221(i)+(wj222(i)*wj222(i)+sigmaj22)*thetac222(i)+wj222(i)*wj223(i)*thetac223(i)+...
        wj222(i)*wj224(i)*thetac224(i)+wj222(i)*wj225(i)*thetac225(i)+wj222(i)*wj226(i)*thetac226(i)+wj222(i)*wj227(i)*thetac227(i)+...
        wj222(i)*wj228(i)*thetac228(i))-thetac222(i));
    thetac223(i+1)=thetac223(i)+h*(-betac22*(wj223(i)*wj221(i)*thetac221(i)+wj223(i)*wj222(i)*thetac222(i)+(wj223(i)*wj223(i)+sigmaj22)*thetac223(i)+...
        wj223(i)*wj224(i)*thetac224(i)+wj223(i)*wj225(i)*thetac225(i)+wj223(i)*wj226(i)*thetac226(i)+wj223(i)*wj227(i)*thetac227(i)+...
        wj223(i)*wj228(i)*thetac228(i))-thetac223(i));
    thetac224(i+1)=thetac224(i)+h*(-betac22*(wj224(i)*wj221(i)*thetac221(i)+wj224(i)*wj222(i)*thetac222(i)+wj224(i)*wj223(i)*thetac223(i)+...
        (wj224(i)*wj224(i)+sigmaj22)*thetac224(i)+wj224(i)*wj225(i)*thetac225(i)+wj224(i)*wj226(i)*thetac226(i)+wj224(i)*wj227(i)*thetac227(i)+...
        wj224(i)*wj228(i)*thetac228(i))-thetac224(i));
    thetac225(i+1)=thetac225(i)+h*(-betac22*(wj225(i)*wj221(i)*thetac221(i)+wj225(i)*wj222(i)*thetac222(i)+wj225(i)*wj223(i)*thetac223(i)+...
        wj225(i)*wj224(i)*thetac224(i)+(wj225(i)*wj225(i)+sigmaj22)*thetac225(i)+wj225(i)*wj226(i)*thetac226(i)+wj225(i)*wj227(i)*thetac227(i)+...
        wj225(i)*wj228(i)*thetac228(i))-thetac225(i));
    thetac226(i+1)=thetac226(i)+h*(-betac22*(wj226(i)*wj221(i)*thetac221(i)+wj226(i)*wj222(i)*thetac222(i)+wj226(i)*wj223(i)*thetac223(i)+...
        wj226(i)*wj224(i)*thetac224(i)+wj226(i)*wj225(i)*thetac225(i)+(wj226(i)*wj226(i)+sigmaj22)*thetac226(i)+wj226(i)*wj227(i)*thetac227(i)+...
        wj226(i)*wj228(i)*thetac228(i))-thetac226(i));
    thetac227(i+1)=thetac227(i)+h*(-betac22*(wj227(i)*wj221(i)*thetac221(i)+wj227(i)*wj222(i)*thetac222(i)+wj227(i)*wj223(i)*thetac223(i)+...
        wj227(i)*wj224(i)*thetac224(i)+wj227(i)*wj225(i)*thetac225(i)+wj227(i)*wj226(i)*thetac226(i)+(wj227(i)*wj227(i)+sigmaj22)*thetac227(i)+...
        wj227(i)*wj228(i)*thetac228(i))-thetac227(i));
    thetac228(i+1)=thetac228(i)+h*(-betac22*(wj228(i)*wj221(i)*thetac221(i)+wj228(i)*wj222(i)*thetac222(i)+wj228(i)*wj223(i)*thetac223(i)+...
        wj228(i)*wj224(i)*thetac224(i)+wj228(i)*wj225(i)*thetac225(i)+wj228(i)*wj226(i)*thetac226(i)+wj228(i)*wj227(i)*thetac227(i)+...
        (wj228(i)*wj228(i)+sigmaj22)*thetac228(i))-thetac228(i));
     thetaa221(i+1)=thetaa221(i)+h*(-((wj221(i)*wj221(i)+sigmaj22)*(betaa22*(thetaa221(i)-thetac221(i))+betac22*thetac221(i))+wj221(i)*wj222(i)*(betaa22*(thetaa222(i)-thetac222(i))+betac22*thetac222(i))+...
        wj221(i)*wj223(i)*(betaa22*(thetaa223(i)-thetac223(i))+betac22*thetac223(i))+wj221(i)*wj224(i)*(betaa22*(thetaa224(i)-thetac224(i))+betac22*thetac224(i))+...
        wj221(i)*wj225(i)*(betaa22*(thetaa225(i)-thetac225(i))+betac22*thetac225(i))+wj221(i)*wj226(i)*(betaa22*(thetaa226(i)-thetac226(i))+betac22*thetac226(i))+...
        wj221(i)*wj227(i)*(betaa22*(thetaa227(i)-thetac227(i))+betac22*thetac227(i))+wj221(i)*wj228(i)*(betaa22*(thetaa228(i)-thetac228(i))+betac22*thetac228(i)))-thetaa221(i));
     thetaa222(i+1)=thetaa222(i)+h*(-(wj222(i)*wj221(i)*(betaa22*(thetaa221(i)-thetac221(i))+betac22*thetac221(i))+(wj222(i)*wj222(i)+sigmaj22)*(betaa22*(thetaa222(i)-thetac222(i))+betac22*thetac222(i))+...
        wj222(i)*wj223(i)*(betaa22*(thetaa223(i)-thetac223(i))+betac22*thetac223(i))+wj222(i)*wj224(i)*(betaa22*(thetaa224(i)-thetac224(i))+betac22*thetac224(i))+...
        wj222(i)*wj225(i)*(betaa22*(thetaa225(i)-thetac225(i))+betac22*thetac225(i))+wj222(i)*wj226(i)*(betaa22*(thetaa226(i)-thetac226(i))+betac22*thetac226(i))+...
        wj222(i)*wj227(i)*(betaa22*(thetaa227(i)-thetac227(i))+betac22*thetac227(i))+wj222(i)*wj228(i)*(betaa22*(thetaa228(i)-thetac228(i))+betac22*thetac228(i)))-thetaa222(i));
    thetaa223(i+1)=thetaa223(i)+h*(-(wj223(i)*wj221(i)*(betaa22*(thetaa221(i)-thetac221(i))+betac22*thetac221(i))+wj223(i)*wj222(i)*(betaa22*(thetaa222(i)-thetac222(i))+betac22*thetac222(i))+...
        (wj223(i)*wj223(i)+sigmaj22)*(betaa22*(thetaa223(i)-thetac223(i))+betac22*thetac223(i))+wj223(i)*wj224(i)*(betaa22*(thetaa224(i)-thetac224(i))+betac22*thetac224(i))+...
        wj223(i)*wj225(i)*(betaa22*(thetaa225(i)-thetac225(i))+betac22*thetac225(i))+wj223(i)*wj226(i)*(betaa22*(thetaa226(i)-thetac226(i))+betac22*thetac226(i))+...
        wj223(i)*wj227(i)*(betaa22*(thetaa227(i)-thetac227(i))+betac22*thetac227(i))+wj223(i)*wj228(i)*(betaa22*(thetaa228(i)-thetac228(i))+betac22*thetac228(i)))-thetaa223(i));
    thetaa224(i+1)=thetaa224(i)+h*(-(wj224(i)*wj221(i)*(betaa22*(thetaa221(i)-thetac221(i))+betac22*thetac221(i))+wj224(i)*wj222(i)*(betaa22*(thetaa222(i)-thetac222(i))+betac22*thetac222(i))+...
        wj224(i)*wj223(i)*(betaa22*(thetaa223(i)-thetac223(i))+betac22*thetac223(i))+(wj224(i)*wj224(i)+sigmaj22)*(betaa22*(thetaa224(i)-thetac224(i))+betac22*thetac224(i))+...
        wj224(i)*wj225(i)*(betaa22*(thetaa225(i)-thetac225(i))+betac22*thetac225(i))+wj224(i)*wj226(i)*(betaa22*(thetaa226(i)-thetac226(i))+betac22*thetac226(i))+...
        wj224(i)*wj227(i)*(betaa22*(thetaa227(i)-thetac227(i))+betac22*thetac227(i))+wj224(i)*wj228(i)*(betaa22*(thetaa228(i)-thetac228(i))+betac22*thetac228(i)))-thetaa224(i));
    thetaa225(i+1)=thetaa225(i)+h*(-(wj225(i)*wj221(i)*(betaa22*(thetaa221(i)-thetac221(i))+betac22*thetac221(i))+wj225(i)*wj222(i)*(betaa22*(thetaa222(i)-thetac222(i))+betac22*thetac222(i))+...
        wj225(i)*wj223(i)*(betaa22*(thetaa223(i)-thetac223(i))+betac22*thetac223(i))+wj225(i)*wj224(i)*(betaa22*(thetaa224(i)-thetac224(i))+betac22*thetac224(i))+...
        (wj225(i)*wj225(i)+sigmaj22)*(betaa22*(thetaa225(i)-thetac225(i))+betac22*thetac225(i))+wj225(i)*wj226(i)*(betaa22*(thetaa226(i)-thetac226(i))+betac22*thetac226(i))+...
        wj225(i)*wj227(i)*(betaa22*(thetaa227(i)-thetac227(i))+betac22*thetac227(i))+wj225(i)*wj228(i)*(betaa22*(thetaa228(i)-thetac228(i))+betac22*thetac228(i)))-thetaa225(i));
    thetaa226(i+1)=thetaa226(i)+h*(-(wj226(i)*wj221(i)*(betaa22*(thetaa221(i)-thetac221(i))+betac22*thetac221(i))+wj226(i)*wj222(i)*(betaa22*(thetaa222(i)-thetac222(i))+betac22*thetac222(i))+...
        wj226(i)*wj223(i)*(betaa22*(thetaa223(i)-thetac223(i))+betac22*thetac223(i))+wj226(i)*wj224(i)*(betaa22*(thetaa224(i)-thetac224(i))+betac22*thetac224(i))+...
        wj226(i)*wj225(i)*(betaa22*(thetaa225(i)-thetac225(i))+betac22*thetac225(i))+(wj226(i)*wj226(i)+sigmaj22)*(betaa22*(thetaa226(i)-thetac226(i))+betac22*thetac226(i))+...
        wj226(i)*wj227(i)*(betaa22*(thetaa227(i)-thetac227(i))+betac22*thetac227(i))+wj226(i)*wj228(i)*(betaa22*(thetaa228(i)-thetac228(i))+betac22*thetac228(i)))-thetaa226(i));
    thetaa227(i+1)=thetaa227(i)+h*(-(wj227(i)*wj221(i)*(betaa22*(thetaa221(i)-thetac221(i))+betac22*thetac221(i))+wj227(i)*wj222(i)*(betaa22*(thetaa222(i)-thetac222(i))+betac22*thetac222(i))+...
        wj227(i)*wj223(i)*(betaa22*(thetaa223(i)-thetac223(i))+betac22*thetac223(i))+wj227(i)*wj224(i)*(betaa22*(thetaa224(i)-thetac224(i))+betac22*thetac224(i))+...
        wj227(i)*wj225(i)*(betaa22*(thetaa225(i)-thetac225(i))+betac22*thetac225(i))+wj227(i)*wj226(i)*(betaa22*(thetaa226(i)-thetac226(i))+betac22*thetac226(i))+...
        (wj227(i)*wj227(i)+sigmaj22)*(betaa22*(thetaa227(i)-thetac227(i))+betac22*thetac227(i))+wj227(i)*wj228(i)*(betaa22*(thetaa228(i)-thetac228(i))+betac22*thetac228(i)))-thetaa227(i));
    thetaa228(i+1)=thetaa228(i)+h*(-(wj228(i)*wj221(i)*(betaa22*(thetaa221(i)-thetac221(i))+betac22*thetac221(i))+wj228(i)*wj222(i)*(betaa22*(thetaa222(i)-thetac222(i))+betac22*thetac222(i))+...
        wj228(i)*wj223(i)*(betaa22*(thetaa223(i)-thetac223(i))+betac22*thetac223(i))+wj228(i)*wj224(i)*(betaa22*(thetaa224(i)-thetac224(i))+betac22*thetac224(i))+...
        wj228(i)*wj225(i)*(betaa22*(thetaa225(i)-thetac225(i))+betac22*thetac225(i))+wj228(i)*wj226(i)*(betaa22*(thetaa226(i)-thetac226(i))+betac22*thetac226(i))+...
        wj228(i)*wj227(i)*(betaa22*(thetaa227(i)-thetac227(i))+betac22*thetac227(i))+(wj228(i)*wj228(i)+sigmaj22)*(betaa22*(thetaa228(i)-thetac228(i))+betac22*thetac228(i)))-thetaa228(i));
    u2(i)=-A22.*(p3(i)-psi210(i))+A22.*phi22.*((p3(i)-psi210(i)-E221(i))^r)+psi211(i)-(thetaf221(i)*wf221(i)+thetaf222(i)*wf222(i)+thetaf223(i)*wf223(i)...
        +thetaf224(i)*wf224(i)+thetaf225(i)*wf225(i)+thetaf226(i)*wf226(i)+thetaf227(i)*wf227(i)+thetaf228(i)*wf228(i))-0.5*(thetaa221(i)*wj221(i)...
        +thetaa222(i)*wj222(i)+thetaa223(i)*wj223(i)+thetaa224(i)*wj224(i)+thetaa225(i)*wj225(i)+thetaa226(i)*wj226(i)+thetaa227(i)*wj227(i)+thetaa228(i)*wj228(i));
    thetaf11(i+1)=norm([thetaf111(i+1);thetaf112(i+1);thetaf113(i+1);thetaf114(i+1);thetaf115(i+1);thetaf116(i+1);thetaf117(i+1);thetaf118(i+1)]);
    thetac11(i+1)=norm([thetac111(i+1);thetac112(i+1);thetac113(i+1);thetac114(i+1);thetac115(i+1);thetac116(i+1);thetac117(i+1);thetac118(i+1)]);
    thetaa11(i+1)=norm([thetaa111(i+1);thetaa112(i+1);thetaa113(i+1);thetaa114(i+1);thetaa115(i+1);thetaa116(i+1);thetaa117(i+1);thetaa118(i+1)]);
    thetaf12(i+1)=norm([thetaf121(i+1);thetaf122(i+1);thetaf123(i+1);thetaf124(i+1);thetaf125(i+1);thetaf126(i+1);thetaf127(i+1);thetaf128(i+1)]);
    thetac12(i+1)=norm([thetac121(i+1);thetac122(i+1);thetac123(i+1);thetac124(i+1);thetac125(i+1);thetac126(i+1);thetac127(i+1);thetac128(i+1)]);
    thetaa12(i+1)=norm([thetaa121(i+1);thetaa122(i+1);thetaa123(i+1);thetaa124(i+1);thetaa125(i+1);thetaa126(i+1);thetaa127(i+1);thetaa128(i+1)]);
    thetaf21(i+1)=norm([thetaf211(i+1);thetaf212(i+1);thetaf213(i+1);thetaf214(i+1);thetaf215(i+1);thetaf216(i+1);thetaf217(i+1);thetaf218(i+1)]);
    thetac21(i+1)=norm([thetac211(i+1);thetac212(i+1);thetac213(i+1);thetac214(i+1);thetac215(i+1);thetac216(i+1);thetac217(i+1);thetac218(i+1)]);
    thetaa21(i+1)=norm([thetaa211(i+1);thetaa212(i+1);thetaa213(i+1);thetaa214(i+1);thetaa215(i+1);thetaa216(i+1);thetaa217(i+1);thetaa218(i+1)]);
    thetaf22(i+1)=norm([thetaf221(i+1);thetaf222(i+1);thetaf223(i+1);thetaf224(i+1);thetaf225(i+1);thetaf226(i+1);thetaf227(i+1);thetaf228(i+1)]);
    thetac22(i+1)=norm([thetac221(i+1);thetac222(i+1);thetac223(i+1);thetac224(i+1);thetac225(i+1);thetac226(i+1);thetac227(i+1);thetac228(i+1)]);
    thetaa22(i+1)=norm([thetaa221(i+1);thetaa222(i+1);thetaa223(i+1);thetaa224(i+1);thetaa225(i+1);thetaa226(i+1);thetaa227(i+1);thetaa228(i+1)]);
    z1(i+1)=z1(i)+h*z2(i);
    z2(i+1)=z2(i)+h*(z3(i)-sin(z2(i))-z1(i)+z1(i)*p1(i));
    z3(i+1)=z3(i)+h*(u1(i)+exp(-z2(i))*z1(i)+z3(i));
    p1(i+1)=p1(i)+h*p2(i);
    p2(i+1)=p2(i)+h*(p3(i)+p1(i)+sin(p2(i))+sin(z1(i)));
    p3(i+1)=p3(i)+h*(u2(i)-p2(i)-p3(i));
    h11(i)=abs((z1(i)-sin((i-1)*h)-E111(i))^2+(z2(i)-cos((i-1)*h)-E112(i))^2+(a1(i))^2);
    h12(i)=abs(((z3(i)-psi110(i)-E121(i))^2)+(u1(i))^2);
    h21(i)=abs((p1(i)-0.5*sin((i-1)*h)-0.5*sin(0.5*(i-1)*h)-E211(i))*(p1(i)-0.5*sin((i-1)*h)-0.5*sin(0.5*(i-1)*h)-E211(i))+(p2(i)-0.5*cos((i-1)*h)-0.25*cos(0.5*(i-1)*h)-E212(i))*(p2(i)-0.5*cos((i-1)*h)-0.25*cos(0.5*(i-1)*h)-E212(i))+(a2(i))*(a2(i)));
    h22(i)=abs(((p3(i)-psi210(i)-E221(i))^2)+(u2(i))^2);
    u01(i)=abs(real(u1(i)));
    u02(i)=abs(real(u2(i)));
end
%绘制图像
figure;
plot(t,sin(t),'--b','Linewidth',2,'DisplayName','$sin(t)$');
hold on;
plot(t,z1,'-r','Linewidth',2,'DisplayName','$x_{11}$');
xlabel('Time (s)','Fontname','Times New Roman')
ylabel('Tracking performance','Fontname','Times New Roman')
legend;
figure;
plot(t,0.5*sin(t)+0.5*sin(0.5*t),'--b','Linewidth',2,'DisplayName','$0.5sin(t)+0.5sin(0.5t)$');
hold on;
plot(t,p1,'-r','Linewidth',2,'DisplayName','$x_{21}$');
xlabel('Time (s)','Fontname','Times New Roman')
ylabel('Tracking performance','Fontname','Times New Roman')
legend;

%控制器
figure;
plot(t1,u1,'DisplayName','$u_1$');
xlabel('Time (s)','Fontname','Times New Roman')
legend;
figure;
plot(t1,u2,'DisplayName','$u_2$');
xlabel('Time (s)','Fontname','Times New Roman')
legend;

%神经网络权重
figure;
subplot(2,2,1);
plot(t,thetaf11,'r','Linewidth',2,'Displayname','${{\hat \theta }_{{f_{11}}}}$');
xlabel('Time (s)','Fontname','Times New Roman')
ylabel('Identifier NN weight','Fontname','Times New Roman')
legend;
subplot(2,2,2);
plot(t,thetaf12,'g','Linewidth',2,'Displayname','${{\hat \theta }_{{f_{12}}}}$');
xlabel('Time (s)','Fontname','Times New Roman')
ylabel('Identifier NN weight','Fontname','Times New Roman')
legend;
ylim([0, 3]);
subplot(2,2,3);
plot(t,thetaf21,'k','Linewidth',2,'Displayname','${{\hat \theta }_{{f_{21}}}}$');
xlabel('Time (s)','Fontname','Times New Roman')
ylabel('Identifier NN weight','Fontname','Times New Roman')
legend;
subplot(2,2,4);
plot(t,thetaf22,'b','Linewidth',2,'Displayname','${{\hat \theta }_{{f_{22}}}}$');
xlabel('Time (s)','Fontname','Times New Roman')
ylabel('Identifier NN weight','Fontname','Times New Roman')
legend;
ylim([0, 3]);

figure;
subplot(2,2,1);
plot(t,thetac11,'r','Linewidth',2,'Displayname','${{\hat \theta }_{{c_{11}}}}$');
xlabel('Time (s)','Fontname','Times New Roman')
ylabel('Critic NN weight','Fontname','Times New Roman')
legend;
subplot(2,2,2);
plot(t,thetac12,'g','Linewidth',2,'Displayname','${{\hat \theta }_{{c_{12}}}}$');
xlabel('Time (s)','Fontname','Times New Roman')
ylabel('Critic NN weight','Fontname','Times New Roman')
legend;
subplot(2,2,3);
plot(t,thetac21,'k','Linewidth',2,'Displayname','${{\hat \theta }_{{c_{21}}}}$');
xlabel('Time (s)','Fontname','Times New Roman')
ylabel('Critic NN weight','Fontname','Times New Roman')
legend;
subplot(2,2,4);
plot(t,thetac22,'b','Linewidth',2,'Displayname','${{\hat \theta }_{{c_{22}}}}$');
xlabel('Time (s)','Fontname','Times New Roman')
ylabel('Critic NN weight','Fontname','Times New Roman')
legend;

figure;
subplot(2,2,1);
plot(t,thetaa11,'r','Linewidth',2,'Displayname','${{\hat \theta }_{{a_{11}}}}$');
xlabel('Time (s)','Fontname','Times New Roman')
ylabel('Actor NN weight','Fontname','Times New Roman')
legend;
ylim([0, 0.3]);
subplot(2,2,2);
plot(t,thetaa12,'g','Linewidth',2,'Displayname','${{\hat \theta }_{{a_{12}}}}$');
xlabel('Time (s)','Fontname','Times New Roman')
ylabel('Actor NN weight','Fontname','Times New Roman')
legend;
ylim([0, 1]);
subplot(2,2,3);
plot(t,thetaa21,'k','Linewidth',2,'Displayname','${{\hat \theta }_{{a_{21}}}}$');
xlabel('Time (s)','Fontname','Times New Roman')
ylabel('Actor NN weight','Fontname','Times New Roman')
legend;
ylim([0, 0.3]);
subplot(2,2,4);
plot(t,thetaa22,'b','Linewidth',2,'Displayname','${{\hat \theta }_{{a_{22}}}}$');
xlabel('Time (s)','Fontname','Times New Roman')
ylabel('Actor NN weight','Fontname','Times New Roman')
legend;
ylim([0, 1]);


